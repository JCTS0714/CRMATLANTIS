import{e as M,g as d,i as c,k as h,j as r,E as $,t as x,n as K,y as T,p as fe,z as S,F as Z,l as te,A as _,r as j,o as me,G as ke,u as b,H as se,I as ye,C as $e,w as oe,s as ne}from"./vendor-vue-CzwclP9t.js";import{S as Y}from"./vendor-ui-E6c-3yld.js";import{a as W}from"./vendor-utils-Czy7fllw.js";const Ce={class:"bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-slate-900 dark:border-slate-800"},Be={key:0,class:"p-4 border-b border-gray-200 dark:border-slate-800"},Se={class:"flex items-center justify-between"},Ae={class:"text-sm font-semibold text-gray-900 dark:text-slate-100"},Ee={key:0,class:"mt-1 text-xs text-gray-600 dark:text-slate-300"},Pe={key:1,class:"p-4 border-t border-gray-200 dark:border-slate-800"},Te={__name:"BaseCard",props:{title:{type:String,default:""},subtitle:{type:String,default:""},padding:{type:Boolean,default:!0},noPadding:{type:Boolean,default:!1}},setup(e){const t=e,n=M(()=>t.noPadding||!t.padding?"":"p-4");return(o,a)=>(c(),d("div",Ce,[o.$slots.header||e.title?(c(),d("div",Be,[$(o.$slots,"header",{},()=>[r("div",Se,[r("div",null,[r("h3",Ae,x(e.title),1),e.subtitle?(c(),d("p",Ee,x(e.subtitle),1)):h("",!0)]),$(o.$slots,"headerActions")])])])):h("",!0),r("div",{class:K(n.value)},[$(o.$slots,"default")],2),o.$slots.footer?(c(),d("div",Pe,[$(o.$slots,"footer")])):h("",!0)]))}},le={button:{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-4 focus:ring-blue-100 border-transparent",secondary:"bg-white text-gray-700 border-gray-200 hover:bg-gray-50 focus:ring-4 focus:ring-gray-100",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-4 focus:ring-green-100 border-transparent",warning:"bg-amber-500 text-white hover:bg-amber-600 focus:ring-4 focus:ring-amber-100 border-transparent",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-4 focus:ring-red-100 border-transparent",ghost:"text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:ring-4 focus:ring-gray-100"},buttonSize:{xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"},badge:{primary:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-amber-100 text-amber-800",danger:"bg-red-100 text-red-800",info:"bg-sky-100 text-sky-800"},input:{base:"w-full rounded-lg border px-3 py-2 text-sm shadow-sm transition-colors focus:outline-none focus:ring-4",default:"border-gray-200 bg-white text-gray-900 placeholder:text-gray-400 focus:border-blue-500 focus:ring-blue-100",error:"border-red-300 bg-red-50 text-red-900 placeholder:text-red-300 focus:border-red-500 focus:ring-red-100",success:"border-green-300 bg-green-50 text-green-900 placeholder:text-green-300 focus:border-green-500 focus:ring-green-100",disabled:"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}},ze={transition:{fast:"transition-all duration-150 ease-in-out"}},pe=(...e)=>e.filter(Boolean).join(" "),be=(e,t,n=null)=>{const o=le[e];if(!o)return"";let a=o[t]||o.default||"";return n&&le[`${e}Size`]&&(a+=" "+le[`${e}Size`][n]),a},De=["type","disabled"],Me={key:0,class:"inline-flex items-center"},je={key:1},L={__name:"BaseButton",props:{type:{type:String,default:"button"},variant:{type:String,default:"primary",validator:e=>["primary","secondary","danger","success","warning","ghost"].includes(e)},size:{type:String,default:"md",validator:e=>["xs","sm","md","lg","xl"].includes(e)},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"Cargando..."},block:{type:Boolean,default:!1}},emits:["click"],setup(e){const t=e,n=M(()=>pe("inline-flex items-center justify-center font-medium rounded-lg border focus:outline-none focus:ring-4 disabled:opacity-50 disabled:cursor-not-allowed",ze.transition.fast,be("button",t.variant,t.size),t.block&&"w-full"));return(o,a)=>(c(),d("button",{type:e.type,disabled:e.disabled||e.loading,class:K(n.value),onClick:a[0]||(a[0]=s=>o.$emit("click",s))},[e.loading?(c(),d("span",Me,[a[1]||(a[1]=r("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),T(" "+x(e.loadingText),1)])):(c(),d("span",je,[$(o.$slots,"default")]))],10,De))}},Ie={class:"flex items-center justify-between"},Oe={class:"text-sm font-semibold text-gray-900 dark:text-slate-100"},_e={key:0,class:"mt-1 text-xs text-gray-600 dark:text-slate-300"},Ue={class:"flex items-center gap-3"},qe={key:0,class:"text-xs text-gray-600 dark:text-slate-300"},Fe={key:0,class:"p-4 border-b border-gray-200 dark:border-slate-800"},Ve={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Qe={key:0,class:"flex-1"},Le=["for"],Ke=["id","value","placeholder"],Ge={class:"flex items-center gap-2"},He=["value"],We=["value"],Re={key:0,class:"mt-4"},Je={key:1,class:"p-4 border-b border-red-200 bg-red-50 dark:border-red-900/40 dark:bg-red-950/30"},Ne={class:"text-sm text-red-700 dark:text-red-200"},Xe={class:"overflow-x-auto"},Ye={class:"text-xs uppercase bg-gray-50 text-gray-700 dark:bg-slate-800 dark:text-slate-200"},Ze={class:"flex items-center gap-2"},et=["onClick"],tt={key:0},rt=["colspan"],at={key:1},st=["colspan"],ot={key:2,class:"p-4 border-t border-gray-200 dark:border-slate-800"},nt={class:"flex items-center justify-between gap-3"},lt={class:"text-xs text-gray-600 dark:text-slate-300"},it={__name:"GenericTable",props:{tableId:{type:String,default:()=>`table-${Date.now()}`},title:{type:String,required:!0},subtitle:{type:String,default:""},columns:{type:Array,required:!0,validator:e=>e.every(t=>t.key&&t.label)},items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},pagination:{type:Object,default:()=>({current_page:1,last_page:1,total:0,from:null,to:null})},showPagination:{type:Boolean,default:!0},paginationInfo:{type:String,default:""},searchable:{type:Boolean,default:!0},searchQuery:{type:String,default:""},searchPlaceholder:{type:String,default:"Buscar..."},sortable:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!0},showPerPageSelector:{type:Boolean,default:!0},perPage:{type:Number,default:25},perPageOptions:{type:Array,default:()=>[10,15,25,50]},tableClass:{type:String,default:""},emptyMessage:{type:String,default:"No hay datos para mostrar"},rowKey:{type:[String,Function],default:"id"}},emits:["search","sort","page-change","per-page-change"],setup(e){const t=e,n=M(()=>!t.loading&&t.items.length===0),o=(a,s)=>typeof t.rowKey=="function"?t.rowKey(a,s):a[t.rowKey]||s;return(a,s)=>(c(),fe(Te,{title:e.title,subtitle:e.subtitle,"no-padding":""},{header:S(()=>[r("div",Ie,[r("div",null,[r("h3",Oe,x(e.title),1),e.paginationInfo?(c(),d("p",_e,x(e.paginationInfo),1)):h("",!0)]),r("div",Ue,[$(a.$slots,"headerActions"),e.loading?(c(),d("div",qe,"Cargando…")):h("",!0)])])]),default:S(()=>[e.showFilters?(c(),d("div",Fe,[r("div",Ve,[e.searchable?(c(),d("div",Qe,[r("label",{class:"sr-only",for:`${e.tableId}-search`},"Buscar",8,Le),r("input",{id:`${e.tableId}-search`,value:e.searchQuery,type:"search",placeholder:e.searchPlaceholder,class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-400 shadow-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-100 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500",onInput:s[0]||(s[0]=l=>a.$emit("search",l.target.value))},null,40,Ke)])):h("",!0),r("div",Ge,[$(a.$slots,"filters"),e.showPerPageSelector?(c(),d("select",{key:0,value:e.perPage,class:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-100 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100",onChange:s[1]||(s[1]=l=>a.$emit("per-page-change",Number(l.target.value)))},[(c(!0),d(Z,null,te(e.perPageOptions,l=>(c(),d("option",{key:l,value:l},x(l),9,We))),128))],40,He)):h("",!0)])]),a.$slots.secondaryFilters?(c(),d("div",Re,[$(a.$slots,"secondaryFilters")])):h("",!0)])):h("",!0),e.error?(c(),d("div",Je,[r("div",Ne,x(e.error),1)])):h("",!0),r("div",Xe,[r("table",{class:K(["w-full text-sm text-left text-gray-700 dark:text-slate-200",e.tableClass])},[r("thead",Ye,[r("tr",null,[(c(!0),d(Z,null,te(e.columns,l=>(c(),d("th",{key:l.key,class:K(["px-4 py-3",l.headerClass])},[r("div",Ze,[T(x(l.label)+" ",1),l.sortable&&e.sortable?(c(),d("button",{key:0,type:"button",class:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300",onClick:p=>a.$emit("sort",l.key)},[...s[4]||(s[4]=[r("svg",{class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{d:"M5 12l5 5 5-5H5z"})],-1)])],8,et)):h("",!0)])],2))),128))])]),r("tbody",null,[(c(!0),d(Z,null,te(e.items,(l,p)=>$(a.$slots,"row",{key:o(l,p),item:l,index:p,columns:e.columns})),128)),n.value?(c(),d("tr",tt,[r("td",{colspan:e.columns.length,class:"px-4 py-10 text-center text-sm text-gray-600 dark:text-slate-300"},[$(a.$slots,"empty",{},()=>[T(x(e.emptyMessage),1)])],8,rt)])):h("",!0),e.loading&&e.items.length===0?(c(),d("tr",at,[r("td",{colspan:e.columns.length,class:"px-4 py-10 text-center text-sm text-gray-600 dark:text-slate-300"},[...s[5]||(s[5]=[r("div",{class:"flex items-center justify-center gap-2"},[r("svg",{class:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),T(" Cargando… ")],-1)])],8,st)])):h("",!0)])],2)]),e.showPagination&&e.pagination&&e.pagination.last_page>1?(c(),d("div",ot,[r("div",nt,[_(L,{variant:"secondary",size:"sm",disabled:e.loading||e.pagination.current_page<=1,onClick:s[2]||(s[2]=l=>a.$emit("page-change",e.pagination.current_page-1))},{default:S(()=>[...s[6]||(s[6]=[T(" Anterior ",-1)])]),_:1},8,["disabled"]),r("div",lt,[$(a.$slots,"paginationInfo",{},()=>[T(" Página "+x(e.pagination.current_page)+" / "+x(e.pagination.last_page),1)])]),_(L,{variant:"secondary",size:"sm",disabled:e.loading||e.pagination.current_page>=e.pagination.last_page,onClick:s[3]||(s[3]=l=>a.$emit("page-change",e.pagination.current_page+1))},{default:S(()=>[...s[7]||(s[7]=[T(" Siguiente ",-1)])]),_:1},8,["disabled"])])])):h("",!0)]),_:3},8,["title","subtitle"]))}};function ct(e={}){const{closeOnEscape:t=!0,closeOnBackdrop:n=!0,preventBodyScroll:o=!0}=e,a=j(!1),s=j(!1),l=()=>{a.value=!0,o&&(document.body.style.overflow="hidden")},p=()=>{s.value||(s.value=!0,setTimeout(()=>{a.value=!1,s.value=!1,o&&(document.body.style.overflow="")},150))},C=()=>{a.value?p():l()},D=m=>{t&&m.key==="Escape"&&a.value&&p()},I=m=>{n&&m.target===m.currentTarget&&p()};return me(()=>{t&&document.addEventListener("keydown",D)}),ke(()=>{t&&document.removeEventListener("keydown",D),o&&a.value&&(document.body.style.overflow="")}),{isOpen:a,isAnimating:s,open:l,close:p,toggle:C,handleBackdrop:I}}const dt={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},ut={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},gt={key:0,class:"px-6 py-4 border-b border-gray-200 dark:border-slate-700"},ft={class:"flex items-center justify-between"},mt={class:"text-lg font-medium leading-6 text-gray-900 dark:text-slate-100",id:"modal-title"},yt={key:0,class:"mt-1 text-sm text-gray-500 dark:text-slate-400"},pt={class:"px-6 py-4 bg-white dark:bg-slate-900"},bt={key:1,class:"px-6 py-4 bg-gray-50 border-t border-gray-200 dark:bg-slate-800 dark:border-slate-700"},ht={__name:"BaseModal",props:{title:{type:String,default:""},subtitle:{type:String,default:""},maxWidth:{type:String,default:"2xl",validator:e=>["sm","md","lg","xl","2xl","3xl","4xl","5xl","6xl"].includes(e)},showCloseButton:{type:Boolean,default:!0},closeOnEscape:{type:Boolean,default:!0},closeOnBackdrop:{type:Boolean,default:!0}},emits:["close","open"],setup(e,{expose:t,emit:n}){const o=e,a=n,s={sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl","3xl":"sm:max-w-3xl","4xl":"sm:max-w-4xl","5xl":"sm:max-w-5xl","6xl":"sm:max-w-6xl"},l=M(()=>s[o.maxWidth]||s["2xl"]),{isOpen:p,isAnimating:C,open:D,close:I,handleBackdrop:m}=ct({closeOnEscape:o.closeOnEscape,closeOnBackdrop:o.closeOnBackdrop}),B=()=>{D(),a("open")},z=()=>{I(),a("close")};return t({open:B,close:z,isOpen:p}),(A,y)=>b(p)?(c(),d("div",dt,[r("div",{class:K(["fixed inset-0 bg-gray-500/75 transition-opacity dark:bg-gray-900/80",{"opacity-100":!b(C),"opacity-0":b(C)}]),onClick:y[0]||(y[0]=(...U)=>b(m)&&b(m)(...U))},null,2),r("div",ut,[r("div",{class:K(["relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all dark:bg-slate-900",[l.value,{"translate-y-0 opacity-100 sm:scale-100":!b(C),"translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95":b(C)}]])},[A.$slots.header||e.title?(c(),d("div",gt,[r("div",ft,[r("div",null,[$(A.$slots,"header",{},()=>[r("h3",mt,x(e.title),1),e.subtitle?(c(),d("p",yt,x(e.subtitle),1)):h("",!0)])]),e.showCloseButton?(c(),d("button",{key:0,type:"button",class:"rounded-md bg-white text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-slate-900 dark:hover:text-slate-300",onClick:z},[...y[1]||(y[1]=[r("span",{class:"sr-only"},"Cerrar",-1),r("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])):h("",!0)])])):h("",!0),r("div",pt,[$(A.$slots,"default")]),A.$slots.footer?(c(),d("div",bt,[$(A.$slots,"footer")])):h("",!0)],2)])])):h("",!0)}},xt={__name:"BaseBadge",props:{variant:{type:String,default:"secondary",validator:e=>["primary","secondary","success","warning","danger","info"].includes(e)},size:{type:String,default:"sm",validator:e=>["xs","sm","md"].includes(e)},rounded:{type:Boolean,default:!1}},setup(e){const t=e,n=M(()=>{const o={xs:"px-1.5 py-0.5 text-xs",sm:"px-2 py-1 text-xs",md:"px-2.5 py-1.5 text-sm"};return pe("inline-flex items-center font-medium",t.rounded?"rounded-full":"rounded-md",o[t.size],be("badge",t.variant))});return(o,a)=>(c(),d("span",{class:K(n.value)},[$(o.$slots,"default")],2))}};function vt(e={}){const{endpoint:t,columns:n=[],defaultFilters:o={},actions:a={},defaultPerPage:s=25,searchDebounce:l=300,transformData:p=null,onError:C=null}=e,D=j(!1),I=j(null),m=j([]),B=j([]),z=se({current_page:1,last_page:1,per_page:s,total:0,from:null,to:null}),A=se({q:"",page:1,per_page:s,sort_by:null,sort_direction:"asc",...o}),y=se({sortColumn:null,sortDirection:"asc",searchQuery:"",processing:new Set}),U=M(()=>m.value.length>0),O=M(()=>!D.value&&m.value.length===0),R=M(()=>z.total||0),J=M(()=>{if(!z.total)return"";const i=z.from||0,f=z.to||0,F=z.total||0;return`${i}-${f} de ${F}`}),G=M(()=>B.value.length>0),E=M(()=>U.value&&m.value.every(i=>B.value.includes(i.id))),H=async(i={})=>{var f,F,V;if(!t){console.error("useGenericTable: endpoint is required");return}D.value=!0,I.value=null;try{const P={...A,...i},k=await W.get(t,{params:P});let g=((f=k.data)==null?void 0:f.data)||k.data;p&&typeof p=="function"&&(g=p(g)),m.value=(g==null?void 0:g.items)||g||[],g!=null&&g.pagination&&Object.assign(z,g.pagination)}catch(P){const k=((V=(F=P.response)==null?void 0:F.data)==null?void 0:V.message)||"Error al cargar los datos";I.value=k,C&&typeof C=="function"?C(P,k):console.error("Table fetch error:",P)}finally{D.value=!1}},Q=async(i={})=>{Object.assign(A,i),await H()},re=async i=>{await Q({page:i})},ee=async i=>{await Q({per_page:i,page:1})},N=async i=>{y.searchQuery=i,await Q({q:i,page:1})},v=async i=>{let f="asc";y.sortColumn===i&&(f=y.sortDirection==="asc"?"desc":"asc"),y.sortColumn=i,y.sortDirection=f,await Q({sort_by:i,sort_direction:f,page:1})},u=async()=>{await H()},w=async()=>{Object.assign(A,{q:"",page:1,per_page:s,sort_by:null,sort_direction:"asc",...o}),y.sortColumn=null,y.sortDirection="asc",y.searchQuery="",await H()},X=i=>{B.value.includes(i)||B.value.push(i)},q=i=>{const f=B.value.indexOf(i);f>-1&&B.value.splice(f,1)},he=i=>{B.value.includes(i)?q(i):X(i)},ie=()=>{B.value=m.value.map(i=>i.id)},ce=()=>{B.value=[]},xe=()=>{E.value?ce():ie()},de=async(i,f,F=null)=>{var V,P;if(!a[i])return console.error(`Action '${i}' is not defined`),!1;y.processing.add(f);try{const k=await a[i](f,F);if(i==="delete"){const g=m.value.findIndex(ae=>ae.id===f);g>-1&&m.value.splice(g,1),q(f)}else if(k!=null&&k.data){const g=m.value.findIndex(ae=>ae.id===f);g>-1&&(m.value[g]={...m.value[g],...k.data})}return k}catch(k){const g=((P=(V=k.response)==null?void 0:V.data)==null?void 0:P.message)||`Error en acción ${i}`;throw I.value=g,k}finally{y.processing.delete(f)}},ve=async(i,f,F=null)=>{const V=[],P=[];for(const k of f)try{const g=await de(i,k,F);V.push({id:k,result:g})}catch(g){P.push({id:k,error:g})}return P.length>0&&console.error("Bulk action errors:",P),{results:V,errors:P}},we=i=>y.processing.has(i);let ue;const ge=i=>{clearTimeout(ue),ue=setTimeout(()=>{N(i)},l)};return ye(()=>y.searchQuery,(i,f)=>{i!==f&&ge(i)}),{loading:D,error:I,items:m,pagination:z,filters:A,tableState:y,selectedItems:B,hasData:U,isEmpty:O,totalCount:R,paginationInfo:J,hasSelectedItems:G,allItemsSelected:E,fetchData:H,applyFilters:Q,changePage:re,changePerPage:ee,handleSearch:N,handleSort:v,refresh:u,reset:w,selectItem:X,unselectItem:q,toggleSelection:he,selectAll:ie,unselectAll:ce,toggleSelectAll:xe,performAction:de,bulkAction:ve,isProcessing:we,debouncedSearch:ge}}class wt{constructor(t){this.baseEndpoint=t}async create(t){try{return(await W.post(this.baseEndpoint,t)).data}catch(n){throw n}}async update(t,n){try{return(await W.patch(`${this.baseEndpoint}/${t}`,n)).data}catch(o){throw o}}async delete(t){try{return(await W.delete(`${this.baseEndpoint}/${t}`)).data}catch(n){throw n}}async archive(t){try{return(await W.patch(`${this.baseEndpoint}/${t}/archive`)).data}catch(n){throw n}}async restore(t){try{return(await W.patch(`${this.baseEndpoint}/${t}/restore`)).data}catch(n){throw n}}getSweetAlertTheme(){return document.documentElement.classList.contains("dark")?{background:"#0f172a",color:"#f1f5f9",confirmButtonColor:"#ef4444",cancelButtonColor:"#64748b"}:{background:"#ffffff",color:"#1e293b",confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280"}}async confirmDelete(t,n=null){const o=n||`Se eliminará permanentemente "${t}"`,a=this.getSweetAlertTheme();return(await Y.fire({title:"¿Eliminar elemento?",text:o,icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:a.confirmButtonColor,cancelButtonColor:a.cancelButtonColor,background:a.background,color:a.color,reverseButtons:!0})).isConfirmed}async confirmArchive(t,n=null){const o=n||`Se archivará "${t}"`,a=this.getSweetAlertTheme();return(await Y.fire({title:"¿Archivar elemento?",text:o,icon:"question",showCancelButton:!0,confirmButtonText:"Sí, archivar",cancelButtonText:"Cancelar",confirmButtonColor:"#f59e0b",cancelButtonColor:a.cancelButtonColor,background:a.background,color:a.color,reverseButtons:!0})).isConfirmed}async confirmBulkAction(t,n){const o=this.getSweetAlertTheme(),s={delete:{title:"¿Eliminar elementos?",text:`Se eliminarán ${n} elementos permanentemente`,confirmText:"Sí, eliminar todos",color:"#ef4444"},archive:{title:"¿Archivar elementos?",text:`Se archivarán ${n} elementos`,confirmText:"Sí, archivar todos",color:"#f59e0b"}}[t];return s?(await Y.fire({title:s.title,text:s.text,icon:"warning",showCancelButton:!0,confirmButtonText:s.confirmText,cancelButtonText:"Cancelar",confirmButtonColor:s.color,cancelButtonColor:o.cancelButtonColor,background:o.background,color:o.color,reverseButtons:!0})).isConfirmed:!1}showSuccess(t,n="¡Éxito!"){const o=this.getSweetAlertTheme();Y.fire({title:n,text:t,icon:"success",timer:2e3,showConfirmButton:!1,background:o.background,color:o.color})}showError(t,n="Error"){const o=this.getSweetAlertTheme();Y.fire({title:n,text:t,icon:"error",background:o.background,color:o.color})}async bulkDelete(t){try{const n=t.map(l=>this.delete(l)),o=await Promise.allSettled(n),a=o.filter(l=>l.status==="fulfilled").length,s=o.filter(l=>l.status==="rejected").length;return s===0?this.showSuccess(`${a} elementos eliminados correctamente`):this.showError(`${a} elementos eliminados, ${s} fallaron`),{successful:a,failed:s}}catch(n){throw n}}async bulkArchive(t){try{const n=t.map(l=>this.archive(l)),o=await Promise.allSettled(n),a=o.filter(l=>l.status==="fulfilled").length,s=o.filter(l=>l.status==="rejected").length;return s===0?this.showSuccess(`${a} elementos archivados correctamente`):this.showError(`${a} elementos archivados, ${s} fallaron`),{successful:a,failed:s}}catch(n){throw n}}}function kt(e){return new wt(e)}function $t(e){const t=kt(e);return{actions:t,performAction:async(a,s,l=null,p="")=>{switch(a){case"delete":return await t.confirmDelete(p)?(await t.delete(s),t.showSuccess("Elemento eliminado correctamente"),!0):!1;case"archive":return await t.confirmArchive(p)?(await t.archive(s),t.showSuccess("Elemento archivado correctamente"),!0):!1;case"update":return await t.update(s,l),t.showSuccess("Elemento actualizado correctamente"),!0;case"create":const C=await t.create(l);return t.showSuccess("Elemento creado correctamente"),C;default:throw new Error(`Action '${a}' not supported`)}},performBulkAction:async(a,s)=>{if(!s.length||!await t.confirmBulkAction(a,s.length))return!1;switch(a){case"delete":return await t.bulkDelete(s);case"archive":return await t.bulkArchive(s);default:throw new Error(`Bulk action '${a}' not supported`)}}}}const Ct={class:"border-b border-gray-100 bg-white hover:bg-blue-50/40 transition-colors dark:border-slate-800 dark:bg-slate-900 dark:hover:bg-slate-800/60"},Bt={class:"px-4 py-3 font-medium text-gray-900 dark:text-slate-100"},St={class:"px-4 py-3"},At={class:"flex items-center gap-3"},Et={class:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center dark:bg-blue-900"},Pt={class:"text-sm font-medium text-blue-600 dark:text-blue-300"},Tt={class:"font-medium text-gray-900 dark:text-slate-100"},zt={class:"text-sm text-gray-500 dark:text-slate-400"},Dt={class:"px-4 py-3"},Mt={class:"flex flex-wrap gap-1"},jt={class:"px-4 py-3 text-sm text-gray-500 dark:text-slate-400"},It={class:"px-4 py-3"},Ot={class:"flex items-center gap-2"},_t={class:"space-y-4"},Ut={key:0},qt={class:"flex justify-end gap-3"},Lt={__name:"UsersTable",setup(e){const t=[{key:"id",label:"ID",sortable:!0},{key:"name",label:"Usuario",sortable:!0},{key:"roles",label:"Roles"},{key:"created_at",label:"Creado",sortable:!0},{key:"actions",label:"Acciones"}],{loading:n,error:o,items:a,pagination:s,filters:l,tableState:p,paginationInfo:C,fetchData:D,changePage:I,changePerPage:m,handleSearch:B,handleSort:z,isProcessing:A,refresh:y}=vt({endpoint:"/users/data",defaultFilters:{},actions:{},defaultPerPage:25}),{performAction:U}=$t("/users"),O=j(null),R=j(!1),J=j(!1),G=j(null),E=j({name:"",email:"",password:""}),H=v=>v?new Date(v).toLocaleString("es-ES"):"",Q=v=>{var u;O.value=v,E.value={name:v.name,email:v.email,password:""},(u=G.value)==null||u.open()},re=async v=>{await U("delete",v.id,null,v.name)&&y()},ee=async()=>{R.value=!0;try{O.value?await U("update",O.value.id,E.value):await U("create",null,E.value),N(),y()}catch(v){console.error("Error saving user:",v)}finally{R.value=!1}},N=()=>{var v;O.value=null,J.value=!1,E.value={name:"",email:"",password:""},(v=G.value)==null||v.close()};return ye(()=>J.value,v=>{var u;v&&((u=G.value)==null||u.open())}),me(async()=>{await D()}),(v,u)=>(c(),d(Z,null,[_(it,{"table-id":"users-table",title:"Usuarios",columns:t,items:b(a),loading:b(n),error:b(o),pagination:b(s),"pagination-info":b(C),"search-query":b(p).searchQuery,"search-placeholder":"Buscar por nombre o email","per-page":b(l).per_page,"per-page-options":[10,25,50,100],sortable:"",onSearch:b(B),onSort:b(z),onPageChange:b(I),onPerPageChange:b(m)},{headerActions:S(()=>[_(L,{variant:"primary",onClick:u[0]||(u[0]=w=>J.value=!0)},{default:S(()=>[...u[4]||(u[4]=[T(" Crear Usuario ",-1)])]),_:1})]),row:S(({item:w})=>{var X;return[r("tr",Ct,[r("td",Bt,x(w.id),1),r("td",St,[r("div",At,[r("div",Et,[r("span",Pt,x((X=w.name)==null?void 0:X.charAt(0).toUpperCase()),1)]),r("div",null,[r("div",Tt,x(w.name),1),r("div",zt,x(w.email),1)])])]),r("td",Dt,[r("div",Mt,[(c(!0),d(Z,null,te(w.roles,q=>(c(),fe(xt,{key:q.id,variant:"primary",size:"xs",rounded:""},{default:S(()=>[T(x(q.name),1)]),_:2},1024))),128))])]),r("td",jt,x(H(w.created_at)),1),r("td",It,[r("div",Ot,[_(L,{variant:"ghost",size:"sm",loading:b(A)(w.id),onClick:q=>Q(w)},{default:S(()=>[...u[5]||(u[5]=[T(" Editar ",-1)])]),_:1},8,["loading","onClick"]),_(L,{variant:"ghost",size:"sm",loading:b(A)(w.id),onClick:q=>re(w)},{default:S(()=>[...u[6]||(u[6]=[T(" Eliminar ",-1)])]),_:1},8,["loading","onClick"])])])])]}),_:1},8,["items","loading","error","pagination","pagination-info","search-query","per-page","onSearch","onSort","onPageChange","onPerPageChange"]),_(ht,{ref_key:"userModal",ref:G,title:O.value?"Editar Usuario":"Crear Usuario","max-width":"lg"},{footer:S(()=>[r("div",qt,[_(L,{variant:"secondary",onClick:N},{default:S(()=>[...u[10]||(u[10]=[T(" Cancelar ",-1)])]),_:1}),_(L,{variant:"primary",loading:R.value,onClick:ee},{default:S(()=>[T(x(O.value?"Actualizar":"Crear"),1)]),_:1},8,["loading"])])]),default:S(()=>[r("form",{onSubmit:$e(ee,["prevent"])},[r("div",_t,[r("div",null,[u[7]||(u[7]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300"}," Nombre ",-1)),oe(r("input",{"onUpdate:modelValue":u[1]||(u[1]=w=>E.value.name=w),type:"text",required:"",class:"mt-1 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100"},null,512),[[ne,E.value.name]])]),r("div",null,[u[8]||(u[8]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300"}," Email ",-1)),oe(r("input",{"onUpdate:modelValue":u[2]||(u[2]=w=>E.value.email=w),type:"email",required:"",class:"mt-1 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100"},null,512),[[ne,E.value.email]])]),O.value?h("",!0):(c(),d("div",Ut,[u[9]||(u[9]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300"}," Contraseña ",-1)),oe(r("input",{"onUpdate:modelValue":u[3]||(u[3]=w=>E.value.password=w),type:"password",required:"",class:"mt-1 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100"},null,512),[[ne,E.value.password]])]))])],32)]),_:1},8,["title"])],64))}};export{Lt as default};
