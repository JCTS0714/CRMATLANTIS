import{e as D,g as d,i as c,k as v,j as s,E as C,t as b,n as L,y as E,p as me,z as $,F as Z,l as te,A as I,r as M,o as ye,G as $e,u as x,H as re,I as pe,C as Ce,w as oe,s as ne}from"./vendor-vue-CzwclP9t.js";import{S as Y}from"./vendor-ui-E6c-3yld.js";import{a as W}from"./vendor-utils-Czy7fllw.js";const Se={class:"bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-slate-900 dark:border-slate-800"},Be={key:0,class:"p-4 border-b border-gray-200 dark:border-slate-800"},Ee={class:"flex items-center justify-between"},Ae={class:"text-sm font-semibold text-gray-900 dark:text-slate-100"},Pe={key:0,class:"mt-1 text-xs text-gray-600 dark:text-slate-300"},Te={key:1,class:"p-4 border-t border-gray-200 dark:border-slate-800"},_e={__name:"BaseCard",props:{title:{type:String,default:""},subtitle:{type:String,default:""},padding:{type:Boolean,default:!0},noPadding:{type:Boolean,default:!1}},setup(e){const t=e,o=D(()=>t.noPadding||!t.padding?"":"p-4");return(n,a)=>(c(),d("div",Se,[n.$slots.header||e.title?(c(),d("div",Be,[C(n.$slots,"header",{},()=>[s("div",Ee,[s("div",null,[s("h3",Ae,b(e.title),1),e.subtitle?(c(),d("p",Pe,b(e.subtitle),1)):v("",!0)]),C(n.$slots,"headerActions")])])])):v("",!0),s("div",{class:L(o.value)},[C(n.$slots,"default")],2),n.$slots.footer?(c(),d("div",Te,[C(n.$slots,"footer")])):v("",!0)]))}},le={button:{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-4 focus:ring-blue-100 border-transparent",secondary:"bg-white text-gray-700 border-gray-200 hover:bg-gray-50 focus:ring-4 focus:ring-gray-100",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-4 focus:ring-green-100 border-transparent",warning:"bg-amber-500 text-white hover:bg-amber-600 focus:ring-4 focus:ring-amber-100 border-transparent",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-4 focus:ring-red-100 border-transparent",ghost:"text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:ring-4 focus:ring-gray-100"},buttonSize:{xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"},badge:{primary:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-amber-100 text-amber-800",danger:"bg-red-100 text-red-800",info:"bg-sky-100 text-sky-800"},input:{base:"w-full rounded-lg border px-3 py-2 text-sm shadow-sm transition-colors focus:outline-none focus:ring-4",default:"border-gray-200 bg-white text-gray-900 placeholder:text-gray-400 focus:border-blue-500 focus:ring-blue-100",error:"border-red-300 bg-red-50 text-red-900 placeholder:text-red-300 focus:border-red-500 focus:ring-red-100",success:"border-green-300 bg-green-50 text-green-900 placeholder:text-green-300 focus:border-green-500 focus:ring-green-100",disabled:"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}},ze={transition:{fast:"transition-all duration-150 ease-in-out"}},be=(...e)=>e.filter(Boolean).join(" "),he=(e,t,o=null)=>{const n=le[e];if(!n)return"";let a=n[t]||n.default||"";return o&&le[`${e}Size`]&&(a+=" "+le[`${e}Size`][o]),a},De=["type","disabled"],Me={key:0,class:"inline-flex items-center"},je={key:1},K={__name:"BaseButton",props:{type:{type:String,default:"button"},variant:{type:String,default:"primary",validator:e=>["primary","secondary","danger","success","warning","ghost"].includes(e)},size:{type:String,default:"md",validator:e=>["xs","sm","md","lg","xl"].includes(e)},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"Cargando..."},block:{type:Boolean,default:!1}},emits:["click"],setup(e){const t=e,o=D(()=>be("inline-flex items-center justify-center font-medium rounded-lg border focus:outline-none focus:ring-4 disabled:opacity-50 disabled:cursor-not-allowed",ze.transition.fast,he("button",t.variant,t.size),t.block&&"w-full"));return(n,a)=>(c(),d("button",{type:e.type,disabled:e.disabled||e.loading,class:L(o.value),onClick:a[0]||(a[0]=r=>n.$emit("click",r))},[e.loading?(c(),d("span",Me,[a[1]||(a[1]=s("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),E(" "+b(e.loadingText),1)])):(c(),d("span",je,[C(n.$slots,"default")]))],10,De))}},Ie={class:"flex items-center justify-between"},Oe={class:"text-sm font-semibold text-gray-900 dark:text-slate-100"},Ue={key:0,class:"mt-1 text-xs text-gray-600 dark:text-slate-300"},qe={class:"flex items-center gap-3"},Fe={key:0,class:"text-xs text-gray-600 dark:text-slate-300"},Ve={key:0,class:"p-4 border-b border-gray-200 dark:border-slate-800"},Qe={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Ke={key:0,class:"flex-1"},Le=["for"],Ge=["id","value","placeholder"],He={class:"flex items-center gap-2"},We=["value"],Re=["value"],Je={key:0,class:"mt-4"},Ne={key:1,class:"p-4 border-b border-red-200 bg-red-50 dark:border-red-900/40 dark:bg-red-950/30"},Xe={class:"text-sm text-red-700 dark:text-red-200"},Ye={class:"overflow-x-auto"},Ze={class:"text-xs uppercase bg-gray-50 text-gray-700 dark:bg-slate-800 dark:text-slate-200"},et={class:"flex items-center gap-2"},tt=["onClick"],st={key:0},at=["colspan"],rt={key:1},ot=["colspan"],nt={key:2,class:"p-4 border-t border-gray-200 dark:border-slate-800"},lt={class:"flex items-center justify-between gap-3"},it={class:"text-xs text-gray-600 dark:text-slate-300"},ct={__name:"GenericTable",props:{tableId:{type:String,default:()=>`table-${Date.now()}`},title:{type:String,required:!0},subtitle:{type:String,default:""},columns:{type:Array,required:!0,validator:e=>e.every(t=>t.key&&t.label)},items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},pagination:{type:Object,default:()=>({current_page:1,last_page:1,total:0,from:null,to:null})},showPagination:{type:Boolean,default:!0},paginationInfo:{type:String,default:""},searchable:{type:Boolean,default:!0},searchQuery:{type:String,default:""},searchPlaceholder:{type:String,default:"Buscar..."},sortable:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!0},showPerPageSelector:{type:Boolean,default:!0},perPage:{type:Number,default:25},perPageOptions:{type:Array,default:()=>[10,15,25,50]},tableClass:{type:String,default:""},emptyMessage:{type:String,default:"No hay datos para mostrar"},rowKey:{type:[String,Function],default:"id"}},emits:["search","sort","page-change","per-page-change"],setup(e){const t=e,o=D(()=>!t.loading&&t.items.length===0),n=(a,r)=>typeof t.rowKey=="function"?t.rowKey(a,r):a[t.rowKey]||r;return(a,r)=>(c(),me(_e,{title:e.title,subtitle:e.subtitle,"no-padding":""},{header:$(()=>[s("div",Ie,[s("div",null,[s("h3",Oe,b(e.title),1),e.paginationInfo?(c(),d("p",Ue,b(e.paginationInfo),1)):v("",!0)]),s("div",qe,[C(a.$slots,"headerActions"),e.loading?(c(),d("div",Fe,"Cargando…")):v("",!0)])])]),default:$(()=>[e.showFilters?(c(),d("div",Ve,[s("div",Qe,[e.searchable?(c(),d("div",Ke,[s("label",{class:"sr-only",for:`${e.tableId}-search`},"Buscar",8,Le),s("input",{id:`${e.tableId}-search`,value:e.searchQuery,type:"search",placeholder:e.searchPlaceholder,class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-400 shadow-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-100 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500",onInput:r[0]||(r[0]=i=>a.$emit("search",i.target.value))},null,40,Ge)])):v("",!0),s("div",He,[C(a.$slots,"filters"),e.showPerPageSelector?(c(),d("select",{key:0,value:e.perPage,class:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-100 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100",onChange:r[1]||(r[1]=i=>a.$emit("per-page-change",Number(i.target.value)))},[(c(!0),d(Z,null,te(e.perPageOptions,i=>(c(),d("option",{key:i,value:i},b(i),9,Re))),128))],40,We)):v("",!0)])]),a.$slots.secondaryFilters?(c(),d("div",Je,[C(a.$slots,"secondaryFilters")])):v("",!0)])):v("",!0),e.error?(c(),d("div",Ne,[s("div",Xe,b(e.error),1)])):v("",!0),s("div",Ye,[s("table",{class:L(["w-full text-sm text-left text-gray-700 dark:text-slate-200",e.tableClass])},[s("thead",Ze,[s("tr",null,[(c(!0),d(Z,null,te(e.columns,i=>(c(),d("th",{key:i.key,class:L(["px-4 py-3",i.headerClass])},[s("div",et,[E(b(i.label)+" ",1),i.sortable&&e.sortable?(c(),d("button",{key:0,type:"button",class:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300",onClick:h=>a.$emit("sort",i.key)},[...r[4]||(r[4]=[s("svg",{class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},[s("path",{d:"M5 12l5 5 5-5H5z"})],-1)])],8,tt)):v("",!0)])],2))),128))])]),s("tbody",null,[(c(!0),d(Z,null,te(e.items,(i,h)=>C(a.$slots,"row",{key:n(i,h),item:i,index:h,columns:e.columns})),128)),o.value?(c(),d("tr",st,[s("td",{colspan:e.columns.length,class:"px-4 py-10 text-center text-sm text-gray-600 dark:text-slate-300"},[C(a.$slots,"empty",{},()=>[E(b(e.emptyMessage),1)])],8,at)])):v("",!0),e.loading&&e.items.length===0?(c(),d("tr",rt,[s("td",{colspan:e.columns.length,class:"px-4 py-10 text-center text-sm text-gray-600 dark:text-slate-300"},[...r[5]||(r[5]=[s("div",{class:"flex items-center justify-center gap-2"},[s("svg",{class:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),E(" Cargando… ")],-1)])],8,ot)])):v("",!0)])],2)]),e.showPagination&&e.pagination&&e.pagination.last_page>1?(c(),d("div",nt,[s("div",lt,[I(K,{variant:"secondary",size:"sm",disabled:e.loading||e.pagination.current_page<=1,onClick:r[2]||(r[2]=i=>a.$emit("page-change",e.pagination.current_page-1))},{default:$(()=>[...r[6]||(r[6]=[E(" Anterior ",-1)])]),_:1},8,["disabled"]),s("div",it,[C(a.$slots,"paginationInfo",{},()=>[E(" Página "+b(e.pagination.current_page)+" / "+b(e.pagination.last_page),1)])]),I(K,{variant:"secondary",size:"sm",disabled:e.loading||e.pagination.current_page>=e.pagination.last_page,onClick:r[3]||(r[3]=i=>a.$emit("page-change",e.pagination.current_page+1))},{default:$(()=>[...r[7]||(r[7]=[E(" Siguiente ",-1)])]),_:1},8,["disabled"])])])):v("",!0)]),_:3},8,["title","subtitle"]))}};function dt(e={}){const{closeOnEscape:t=!0,closeOnBackdrop:o=!0,preventBodyScroll:n=!0}=e,a=M(!1),r=M(!1),i=()=>{a.value=!0,n&&(document.body.style.overflow="hidden")},h=()=>{r.value||(r.value=!0,setTimeout(()=>{a.value=!1,r.value=!1,n&&(document.body.style.overflow="")},150))},S=()=>{a.value?h():i()},z=m=>{t&&m.key==="Escape"&&a.value&&h()},j=m=>{o&&m.target===m.currentTarget&&h()};return ye(()=>{t&&document.addEventListener("keydown",z)}),$e(()=>{t&&document.removeEventListener("keydown",z),n&&a.value&&(document.body.style.overflow="")}),{isOpen:a,isAnimating:r,open:i,close:h,toggle:S,handleBackdrop:j}}const ut={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},gt={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},ft={key:0,class:"px-6 py-4 border-b border-gray-200 dark:border-slate-700"},mt={class:"flex items-center justify-between"},yt={class:"text-lg font-medium leading-6 text-gray-900 dark:text-slate-100",id:"modal-title"},pt={key:0,class:"mt-1 text-sm text-gray-500 dark:text-slate-400"},bt={class:"px-6 py-4"},ht={key:1,class:"px-6 py-4 bg-gray-50 border-t border-gray-200 dark:bg-slate-800 dark:border-slate-700"},xt={__name:"BaseModal",props:{title:{type:String,default:""},subtitle:{type:String,default:""},maxWidth:{type:String,default:"2xl",validator:e=>["sm","md","lg","xl","2xl","3xl","4xl","5xl","6xl"].includes(e)},showCloseButton:{type:Boolean,default:!0},closeOnEscape:{type:Boolean,default:!0},closeOnBackdrop:{type:Boolean,default:!0}},emits:["close","open"],setup(e,{expose:t,emit:o}){const n=e,a=o,r={sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl","3xl":"sm:max-w-3xl","4xl":"sm:max-w-4xl","5xl":"sm:max-w-5xl","6xl":"sm:max-w-6xl"},i=D(()=>r[n.maxWidth]||r["2xl"]),{isOpen:h,isAnimating:S,open:z,close:j,handleBackdrop:m}=dt({closeOnEscape:n.closeOnEscape,closeOnBackdrop:n.closeOnBackdrop}),B=()=>{z(),a("open")},_=()=>{j(),a("close")};return t({open:B,close:_,isOpen:h}),(A,y)=>x(h)?(c(),d("div",ut,[s("div",{class:L(["fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",{"opacity-100":!x(S),"opacity-0":x(S)}]),onClick:y[0]||(y[0]=(...U)=>x(m)&&x(m)(...U))},null,2),s("div",gt,[s("div",{class:L(["relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all dark:bg-slate-900",[i.value,{"translate-y-0 opacity-100 sm:scale-100":!x(S),"translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95":x(S)}]])},[A.$slots.header||e.title?(c(),d("div",ft,[s("div",mt,[s("div",null,[C(A.$slots,"header",{},()=>[s("h3",yt,b(e.title),1),e.subtitle?(c(),d("p",pt,b(e.subtitle),1)):v("",!0)])]),e.showCloseButton?(c(),d("button",{key:0,type:"button",class:"rounded-md bg-white text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-slate-900 dark:hover:text-slate-300",onClick:_},[...y[1]||(y[1]=[s("span",{class:"sr-only"},"Cerrar",-1),s("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])):v("",!0)])])):v("",!0),s("div",bt,[C(A.$slots,"default")]),A.$slots.footer?(c(),d("div",ht,[C(A.$slots,"footer")])):v("",!0)],2)])])):v("",!0)}},fe={__name:"BaseBadge",props:{variant:{type:String,default:"secondary",validator:e=>["primary","secondary","success","warning","danger","info"].includes(e)},size:{type:String,default:"sm",validator:e=>["xs","sm","md"].includes(e)},rounded:{type:Boolean,default:!1}},setup(e){const t=e,o=D(()=>{const n={xs:"px-1.5 py-0.5 text-xs",sm:"px-2 py-1 text-xs",md:"px-2.5 py-1.5 text-sm"};return be("inline-flex items-center font-medium",t.rounded?"rounded-full":"rounded-md",n[t.size],he("badge",t.variant))});return(n,a)=>(c(),d("span",{class:L(o.value)},[C(n.$slots,"default")],2))}};function vt(e={}){const{endpoint:t,columns:o=[],defaultFilters:n={},actions:a={},defaultPerPage:r=25,searchDebounce:i=300,transformData:h=null,onError:S=null}=e,z=M(!1),j=M(null),m=M([]),B=M([]),_=re({current_page:1,last_page:1,per_page:r,total:0,from:null,to:null}),A=re({q:"",page:1,per_page:r,sort_by:null,sort_direction:"asc",...n}),y=re({sortColumn:null,sortDirection:"asc",searchQuery:"",processing:new Set}),U=D(()=>m.value.length>0),O=D(()=>!z.value&&m.value.length===0),R=D(()=>_.total||0),J=D(()=>{if(!_.total)return"";const l=_.from||0,f=_.to||0,F=_.total||0;return`${l}-${f} de ${F}`}),G=D(()=>B.value.length>0),P=D(()=>U.value&&m.value.every(l=>B.value.includes(l.id))),H=async(l={})=>{var f,F,V;if(!t){console.error("useGenericTable: endpoint is required");return}z.value=!0,j.value=null;try{const T={...A,...l},k=await W.get(t,{params:T});let g=((f=k.data)==null?void 0:f.data)||k.data;h&&typeof h=="function"&&(g=h(g)),m.value=(g==null?void 0:g.items)||g||[],g!=null&&g.pagination&&Object.assign(_,g.pagination)}catch(T){const k=((V=(F=T.response)==null?void 0:F.data)==null?void 0:V.message)||"Error al cargar los datos";j.value=k,S&&typeof S=="function"?S(T,k):console.error("Table fetch error:",T)}finally{z.value=!1}},Q=async(l={})=>{Object.assign(A,l),await H()},se=async l=>{await Q({page:l})},ee=async l=>{await Q({per_page:l,page:1})},N=async l=>{y.searchQuery=l,await Q({q:l,page:1})},w=async l=>{let f="asc";y.sortColumn===l&&(f=y.sortDirection==="asc"?"desc":"asc"),y.sortColumn=l,y.sortDirection=f,await Q({sort_by:l,sort_direction:f,page:1})},u=async()=>{await H()},p=async()=>{Object.assign(A,{q:"",page:1,per_page:r,sort_by:null,sort_direction:"asc",...n}),y.sortColumn=null,y.sortDirection="asc",y.searchQuery="",await H()},X=l=>{B.value.includes(l)||B.value.push(l)},q=l=>{const f=B.value.indexOf(l);f>-1&&B.value.splice(f,1)},xe=l=>{B.value.includes(l)?q(l):X(l)},ie=()=>{B.value=m.value.map(l=>l.id)},ce=()=>{B.value=[]},ve=()=>{P.value?ce():ie()},de=async(l,f,F=null)=>{var V,T;if(!a[l])return console.error(`Action '${l}' is not defined`),!1;y.processing.add(f);try{const k=await a[l](f,F);if(l==="delete"){const g=m.value.findIndex(ae=>ae.id===f);g>-1&&m.value.splice(g,1),q(f)}else if(k!=null&&k.data){const g=m.value.findIndex(ae=>ae.id===f);g>-1&&(m.value[g]={...m.value[g],...k.data})}return k}catch(k){const g=((T=(V=k.response)==null?void 0:V.data)==null?void 0:T.message)||`Error en acción ${l}`;throw j.value=g,k}finally{y.processing.delete(f)}},we=async(l,f,F=null)=>{const V=[],T=[];for(const k of f)try{const g=await de(l,k,F);V.push({id:k,result:g})}catch(g){T.push({id:k,error:g})}return T.length>0&&console.error("Bulk action errors:",T),{results:V,errors:T}},ke=l=>y.processing.has(l);let ue;const ge=l=>{clearTimeout(ue),ue=setTimeout(()=>{N(l)},i)};return pe(()=>y.searchQuery,(l,f)=>{l!==f&&ge(l)}),{loading:z,error:j,items:m,pagination:_,filters:A,tableState:y,selectedItems:B,hasData:U,isEmpty:O,totalCount:R,paginationInfo:J,hasSelectedItems:G,allItemsSelected:P,fetchData:H,applyFilters:Q,changePage:se,changePerPage:ee,handleSearch:N,handleSort:w,refresh:u,reset:p,selectItem:X,unselectItem:q,toggleSelection:xe,selectAll:ie,unselectAll:ce,toggleSelectAll:ve,performAction:de,bulkAction:we,isProcessing:ke,debouncedSearch:ge}}class wt{constructor(t){this.baseEndpoint=t}async create(t){try{return(await W.post(this.baseEndpoint,t)).data}catch(o){throw o}}async update(t,o){try{return(await W.patch(`${this.baseEndpoint}/${t}`,o)).data}catch(n){throw n}}async delete(t){try{return(await W.delete(`${this.baseEndpoint}/${t}`)).data}catch(o){throw o}}async archive(t){try{return(await W.patch(`${this.baseEndpoint}/${t}/archive`)).data}catch(o){throw o}}async restore(t){try{return(await W.patch(`${this.baseEndpoint}/${t}/restore`)).data}catch(o){throw o}}async confirmDelete(t,o=null){const n=o||`Se eliminará permanentemente "${t}"`;return(await Y.fire({title:"¿Eliminar elemento?",text:n,icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#ef4444",reverseButtons:!0})).isConfirmed}async confirmArchive(t,o=null){const n=o||`Se archivará "${t}"`;return(await Y.fire({title:"¿Archivar elemento?",text:n,icon:"question",showCancelButton:!0,confirmButtonText:"Sí, archivar",cancelButtonText:"Cancelar",confirmButtonColor:"#f59e0b",reverseButtons:!0})).isConfirmed}async confirmBulkAction(t,o){const a={delete:{title:"¿Eliminar elementos?",text:`Se eliminarán ${o} elementos permanentemente`,confirmText:"Sí, eliminar todos",color:"#ef4444"},archive:{title:"¿Archivar elementos?",text:`Se archivarán ${o} elementos`,confirmText:"Sí, archivar todos",color:"#f59e0b"}}[t];return a?(await Y.fire({title:a.title,text:a.text,icon:"warning",showCancelButton:!0,confirmButtonText:a.confirmText,cancelButtonText:"Cancelar",confirmButtonColor:a.color,reverseButtons:!0})).isConfirmed:!1}showSuccess(t,o="¡Éxito!"){Y.fire({title:o,text:t,icon:"success",timer:2e3,showConfirmButton:!1})}showError(t,o="Error"){Y.fire({title:o,text:t,icon:"error"})}async bulkDelete(t){try{const o=t.map(i=>this.delete(i)),n=await Promise.allSettled(o),a=n.filter(i=>i.status==="fulfilled").length,r=n.filter(i=>i.status==="rejected").length;return r===0?this.showSuccess(`${a} elementos eliminados correctamente`):this.showError(`${a} elementos eliminados, ${r} fallaron`),{successful:a,failed:r}}catch(o){throw o}}async bulkArchive(t){try{const o=t.map(i=>this.archive(i)),n=await Promise.allSettled(o),a=n.filter(i=>i.status==="fulfilled").length,r=n.filter(i=>i.status==="rejected").length;return r===0?this.showSuccess(`${a} elementos archivados correctamente`):this.showError(`${a} elementos archivados, ${r} fallaron`),{successful:a,failed:r}}catch(o){throw o}}}function kt(e){return new wt(e)}function $t(e){const t=kt(e);return{actions:t,performAction:async(a,r,i=null,h="")=>{switch(a){case"delete":return await t.confirmDelete(h)?(await t.delete(r),t.showSuccess("Elemento eliminado correctamente"),!0):!1;case"archive":return await t.confirmArchive(h)?(await t.archive(r),t.showSuccess("Elemento archivado correctamente"),!0):!1;case"update":return await t.update(r,i),t.showSuccess("Elemento actualizado correctamente"),!0;case"create":const S=await t.create(i);return t.showSuccess("Elemento creado correctamente"),S;default:throw new Error(`Action '${a}' not supported`)}},performBulkAction:async(a,r)=>{if(!r.length||!await t.confirmBulkAction(a,r.length))return!1;switch(a){case"delete":return await t.bulkDelete(r);case"archive":return await t.bulkArchive(r);default:throw new Error(`Bulk action '${a}' not supported`)}}}}const Ct={class:"border-b border-gray-100 bg-white hover:bg-blue-50/40 transition-colors dark:border-slate-800 dark:bg-slate-900 dark:hover:bg-slate-800/60"},St={class:"px-4 py-3 font-medium text-gray-900 dark:text-slate-100"},Bt={class:"px-4 py-3"},Et={class:"flex items-center gap-3"},At={class:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center dark:bg-blue-900"},Pt={class:"text-sm font-medium text-blue-600 dark:text-blue-300"},Tt={class:"font-medium text-gray-900 dark:text-slate-100"},_t={class:"text-sm text-gray-500 dark:text-slate-400"},zt={class:"px-4 py-3"},Dt={class:"flex flex-wrap gap-1"},Mt={class:"px-4 py-3"},jt={class:"px-4 py-3 text-sm text-gray-500 dark:text-slate-400"},It={class:"px-4 py-3"},Ot={class:"flex items-center gap-2"},Ut={class:"space-y-4"},qt={key:0},Ft={class:"flex justify-end gap-3"},Lt={__name:"UsersTable",setup(e){const t=[{key:"id",label:"ID",sortable:!0},{key:"name",label:"Usuario",sortable:!0},{key:"roles",label:"Roles"},{key:"email_verified_at",label:"Estado"},{key:"created_at",label:"Creado",sortable:!0},{key:"actions",label:"Acciones"}],{loading:o,error:n,items:a,pagination:r,filters:i,tableState:h,paginationInfo:S,fetchData:z,changePage:j,changePerPage:m,handleSearch:B,handleSort:_,isProcessing:A,refresh:y}=vt({endpoint:"/users/data",defaultFilters:{},actions:{},defaultPerPage:25}),{performAction:U}=$t("/users"),O=M(null),R=M(!1),J=M(!1),G=M(null),P=M({name:"",email:"",password:""}),H=w=>w?new Date(w).toLocaleString("es-ES"):"",Q=w=>{var u;O.value=w,P.value={name:w.name,email:w.email,password:""},(u=G.value)==null||u.open()},se=async w=>{await U("delete",w.id,null,w.name)&&y()},ee=async()=>{R.value=!0;try{O.value?await U("update",O.value.id,P.value):await U("create",null,P.value),N(),y()}catch(w){console.error("Error saving user:",w)}finally{R.value=!1}},N=()=>{var w;O.value=null,J.value=!1,P.value={name:"",email:"",password:""},(w=G.value)==null||w.close()};return pe(()=>J.value,w=>{var u;w&&((u=G.value)==null||u.open())}),ye(async()=>{await z()}),(w,u)=>(c(),d(Z,null,[I(ct,{"table-id":"users-table",title:"Usuarios",columns:t,items:x(a),loading:x(o),error:x(n),pagination:x(r),"pagination-info":x(S),"search-query":x(h).searchQuery,"search-placeholder":"Buscar por nombre o email","per-page":x(i).per_page,"per-page-options":[10,25,50,100],sortable:"",onSearch:x(B),onSort:x(_),onPageChange:x(j),onPerPageChange:x(m)},{headerActions:$(()=>[I(K,{variant:"primary",onClick:u[0]||(u[0]=p=>J.value=!0)},{default:$(()=>[...u[4]||(u[4]=[E(" Crear Usuario ",-1)])]),_:1})]),row:$(({item:p})=>{var X;return[s("tr",Ct,[s("td",St,b(p.id),1),s("td",Bt,[s("div",Et,[s("div",At,[s("span",Pt,b((X=p.name)==null?void 0:X.charAt(0).toUpperCase()),1)]),s("div",null,[s("div",Tt,b(p.name),1),s("div",_t,b(p.email),1)])])]),s("td",zt,[s("div",Dt,[(c(!0),d(Z,null,te(p.roles,q=>(c(),me(fe,{key:q.id,variant:"primary",size:"xs",rounded:""},{default:$(()=>[E(b(q.name),1)]),_:2},1024))),128))])]),s("td",Mt,[I(fe,{variant:p.email_verified_at?"success":"warning",size:"xs",rounded:""},{default:$(()=>[E(b(p.email_verified_at?"Verificado":"Pendiente"),1)]),_:2},1032,["variant"])]),s("td",jt,b(H(p.created_at)),1),s("td",It,[s("div",Ot,[I(K,{variant:"ghost",size:"sm",loading:x(A)(p.id),onClick:q=>Q(p)},{default:$(()=>[...u[5]||(u[5]=[E(" Editar ",-1)])]),_:1},8,["loading","onClick"]),I(K,{variant:"ghost",size:"sm",loading:x(A)(p.id),onClick:q=>se(p)},{default:$(()=>[...u[6]||(u[6]=[E(" Eliminar ",-1)])]),_:1},8,["loading","onClick"])])])])]}),_:1},8,["items","loading","error","pagination","pagination-info","search-query","per-page","onSearch","onSort","onPageChange","onPerPageChange"]),I(xt,{ref_key:"userModal",ref:G,title:O.value?"Editar Usuario":"Crear Usuario","max-width":"lg"},{footer:$(()=>[s("div",Ft,[I(K,{variant:"secondary",onClick:N},{default:$(()=>[...u[10]||(u[10]=[E(" Cancelar ",-1)])]),_:1}),I(K,{variant:"primary",loading:R.value,onClick:ee},{default:$(()=>[E(b(O.value?"Actualizar":"Crear"),1)]),_:1},8,["loading"])])]),default:$(()=>[s("form",{onSubmit:Ce(ee,["prevent"])},[s("div",Ut,[s("div",null,[u[7]||(u[7]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300"}," Nombre ",-1)),oe(s("input",{"onUpdate:modelValue":u[1]||(u[1]=p=>P.value.name=p),type:"text",required:"",class:"mt-1 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100"},null,512),[[ne,P.value.name]])]),s("div",null,[u[8]||(u[8]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300"}," Email ",-1)),oe(s("input",{"onUpdate:modelValue":u[2]||(u[2]=p=>P.value.email=p),type:"email",required:"",class:"mt-1 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100"},null,512),[[ne,P.value.email]])]),O.value?v("",!0):(c(),d("div",qt,[u[9]||(u[9]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300"}," Contraseña ",-1)),oe(s("input",{"onUpdate:modelValue":u[3]||(u[3]=p=>P.value.password=p),type:"password",required:"",class:"mt-1 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100"},null,512),[[ne,P.value.password]])]))])],32)]),_:1},8,["title"])],64))}};export{Lt as default};
