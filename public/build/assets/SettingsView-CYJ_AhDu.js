import{r as l,o as D,f as G,g as y,i as L,j as a,k as R,t as v,C as V}from"./vendor-vue-CzwclP9t.js";const H={class:"max-w-3xl mx-auto"},Z={class:"bg-white dark:bg-slate-900 shadow sm:rounded-lg p-6"},j={key:0,class:"mb-4 text-sm text-green-600"},z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},E={class:"rounded-lg border border-slate-200/60 dark:border-slate-800 p-4"},K={class:"mt-4"},T=["src"],q={class:"mt-2 text-xs text-slate-500 break-all"},X={key:0,class:"text-sm text-red-600"},I={class:"rounded-lg border border-slate-200/60 dark:border-slate-800 p-4"},J={class:"mt-4"},Q=["src"],W={class:"mt-2 text-xs text-slate-500 break-all"},Y={key:0,class:"text-sm text-red-600"},ae={__name:"SettingsView",setup($){const m=l(""),f=l(""),p=l(""),c=l("/images/logo_alta_calidad.png"),i=l("/images/logo_alta_calidad.png"),d=l(c.value),g=l(i.value),s=l(""),r=l(""),b=l(null),h=l(null),x=l(""),k=l("");D(async()=>{try{const t=await fetch("/configuracion/logo-paths");if(t.ok){const e=await t.json();e.mark&&(c.value=e.mark),e.full&&(i.value=e.full||i.value),d.value=c.value,g.value=i.value}}catch{}}),G(()=>{s.value&&URL.revokeObjectURL(s.value),r.value&&URL.revokeObjectURL(r.value)});const P=t=>{var o,u;f.value="";const e=(u=(o=t==null?void 0:t.target)==null?void 0:o.files)==null?void 0:u[0];if(x.value=(e==null?void 0:e.name)??"",!e){d.value=c.value;return}s.value&&URL.revokeObjectURL(s.value),s.value=URL.createObjectURL(e),d.value=s.value},C=t=>{var o,u;p.value="";const e=(u=(o=t==null?void 0:t.target)==null?void 0:o.files)==null?void 0:u[0];if(k.value=(e==null?void 0:e.name)??"",!e){g.value=i.value;return}r.value&&URL.revokeObjectURL(r.value),r.value=URL.createObjectURL(e),g.value=r.value},U=async({endpoint:t,inputRef:e,setError:o,onSuccess:u})=>{var O,F;o(""),m.value="";const _=e.value;if(!_||!_.files||_.files.length===0){o("Selecciona una imagen.");return}const S=new FormData;S.append("logo",_.files[0]);try{const M=((O=document.querySelector('meta[name="csrf-token"]'))==null?void 0:O.getAttribute("content"))??"",w=await fetch(t,{method:"POST",headers:{"X-CSRF-TOKEN":M,Accept:"application/json"},body:S});if(w.ok){const n=await w.json().catch(()=>null);m.value=(n==null?void 0:n.message)??"Actualizado correctamente.",u(n);return}if(w.status===422){const n=await w.json().catch(()=>null),B=n!=null&&n.errors?(F=Object.values(n.errors).flat())==null?void 0:F[0]:null;o(B??"La imagen no es válida.");return}o("Error al subir imagen.")}catch{o("Error de conexión.")}},N=async()=>{await U({endpoint:"/configuracion/logo-mark",inputRef:b,setError:t=>f.value=t,onSuccess:t=>{c.value=((t==null?void 0:t.path)??"/storage/settings/logo_mark.png")+"?ts="+Date.now(),d.value=c.value,s.value&&(URL.revokeObjectURL(s.value),s.value=""),window.__APP_LOGO_MARK__=(t==null?void 0:t.path)??"/storage/settings/logo_mark.png",x.value="",b.value&&(b.value.value="")}})},A=async()=>{await U({endpoint:"/configuracion/logo-full",inputRef:h,setError:t=>p.value=t,onSuccess:t=>{i.value=((t==null?void 0:t.path)??"/storage/settings/logo_full.png")+"?ts="+Date.now(),g.value=i.value,r.value&&(URL.revokeObjectURL(r.value),r.value=""),window.__APP_LOGO_FULL__=(t==null?void 0:t.path)??"/storage/settings/logo_full.png",k.value="",h.value&&(h.value.value="")}})};return(t,e)=>(L(),y("div",H,[a("div",Z,[e[10]||(e[10]=a("h2",{class:"text-lg font-semibold mb-4"},"Personalización",-1)),m.value?(L(),y("div",j,v(m.value),1)):R("",!0),a("div",z,[a("section",E,[e[2]||(e[2]=a("h3",{class:"font-medium"},"Ícono (logo puro)",-1)),e[3]||(e[3]=a("p",{class:"text-sm text-slate-500"},"Se usa en el login y en el menú contraído.",-1)),e[4]||(e[4]=a("p",{class:"mt-1 text-xs text-slate-500"}," Recomendado: PNG con fondo transparente, 256×256 (mín. 128×128). Se mostrará aprox. a 56×56 en el menú y 56×56 en login. ",-1)),a("div",K,[a("img",{src:d.value,alt:"Ícono actual",class:"w-28 h-28 object-contain rounded-md border bg-white p-2"},null,8,T)]),a("form",{onSubmit:V(N,["prevent"]),class:"mt-4"},[a("input",{id:"file-logo-mark",type:"file",ref_key:"fileMark",ref:b,accept:"image/*",class:"sr-only",onChange:P},null,544),e[0]||(e[0]=a("label",{for:"file-logo-mark",class:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-950 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-900 cursor-pointer"},[a("svg",{class:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[a("path",{d:"M3 4a2 2 0 0 1 2-2h6a1 1 0 1 1 0 2H5v12h10V9a1 1 0 1 1 2 0v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4Z"}),a("path",{d:"M14 2a1 1 0 0 1 1 1v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 1 1-2 0V7h-2a1 1 0 1 1 0-2h2V3a1 1 0 0 1 1-1Z"})]),a("span",null,"Seleccionar archivo")],-1)),a("p",q,v(x.value?x.value:"Ningún archivo seleccionado"),1),f.value?(L(),y("div",X,v(f.value),1)):R("",!0),e[1]||(e[1]=a("div",{class:"mt-4"},[a("button",{type:"submit",class:"inline-flex items-center justify-center px-4 py-2 rounded-lg bg-indigo-600 text-white font-medium shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 disabled:opacity-60"}," Subir ícono ")],-1))],32)]),a("section",I,[e[7]||(e[7]=a("h3",{class:"font-medium"},"Logo grande (ícono + nombre)",-1)),e[8]||(e[8]=a("p",{class:"text-sm text-slate-500"},"Se usa en el menú expandido.",-1)),e[9]||(e[9]=a("p",{class:"mt-1 text-xs text-slate-500"}," Recomendado: PNG transparente, proporción 4:1 (ej. 640×160 o 800×200). Se mostrará aprox. a 224×56 en el menú. ",-1)),a("div",J,[a("img",{src:g.value,alt:"Logo grande actual",class:"w-full h-24 object-contain rounded-md border bg-white p-2"},null,8,Q)]),a("form",{onSubmit:V(A,["prevent"]),class:"mt-4"},[a("input",{id:"file-logo-full",type:"file",ref_key:"fileFull",ref:h,accept:"image/*",class:"sr-only",onChange:C},null,544),e[5]||(e[5]=a("label",{for:"file-logo-full",class:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-950 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-900 cursor-pointer"},[a("svg",{class:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[a("path",{d:"M3 4a2 2 0 0 1 2-2h6a1 1 0 1 1 0 2H5v12h10V9a1 1 0 1 1 2 0v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4Z"}),a("path",{d:"M14 2a1 1 0 0 1 1 1v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 1 1-2 0V7h-2a1 1 0 1 1 0-2h2V3a1 1 0 0 1 1-1Z"})]),a("span",null,"Seleccionar archivo")],-1)),a("p",W,v(k.value?k.value:"Ningún archivo seleccionado"),1),p.value?(L(),y("div",Y,v(p.value),1)):R("",!0),e[6]||(e[6]=a("div",{class:"mt-4"},[a("button",{type:"submit",class:"inline-flex items-center justify-center px-4 py-2 rounded-lg bg-indigo-600 text-white font-medium shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 disabled:opacity-60"}," Subir logo grande ")],-1))],32)])])])]))}};export{ae as default};
