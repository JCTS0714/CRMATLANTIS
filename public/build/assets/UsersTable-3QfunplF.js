import{e as j,g as u,i as d,k as y,j as t,E as C,t as x,n as K,y as D,p as me,z as A,F as Z,l as te,A as O,r as _,o as be,G as $e,u as h,H as ae,I as ye,J as fe,C as Ce,w as oe,s as ne}from"./vendor-vue-DArGLcBM.js";import{S as Y}from"./vendor-ui-CyZqwBXe.js";import{a as J}from"./vendor-utils-Czy7fllw.js";const Be={class:"bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-slate-900 dark:border-slate-800"},Se={key:0,class:"p-4 border-b border-gray-200 dark:border-slate-800"},Ae={class:"flex items-center justify-between"},Ee={class:"text-sm font-semibold text-gray-900 dark:text-slate-100"},Pe={key:0,class:"mt-1 text-xs text-gray-600 dark:text-slate-300"},Te={key:1,class:"p-4 border-t border-gray-200 dark:border-slate-800"},ze={__name:"BaseCard",props:{title:{type:String,default:""},subtitle:{type:String,default:""},padding:{type:Boolean,default:!0},noPadding:{type:Boolean,default:!1}},setup(e){const s=e,n=j(()=>s.noPadding||!s.padding?"":"p-4");return(o,r)=>(d(),u("div",Be,[o.$slots.header||e.title?(d(),u("div",Se,[C(o.$slots,"header",{},()=>[t("div",Ae,[t("div",null,[t("h3",Ee,x(e.title),1),e.subtitle?(d(),u("p",Pe,x(e.subtitle),1)):y("",!0)]),C(o.$slots,"headerActions")])])])):y("",!0),t("div",{class:K(n.value)},[C(o.$slots,"default")],2),o.$slots.footer?(d(),u("div",Te,[C(o.$slots,"footer")])):y("",!0)]))}},le={button:{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-4 focus:ring-blue-100 border-transparent",secondary:"bg-white text-gray-700 border-gray-200 hover:bg-gray-50 focus:ring-4 focus:ring-gray-100",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-4 focus:ring-green-100 border-transparent",warning:"bg-amber-500 text-white hover:bg-amber-600 focus:ring-4 focus:ring-amber-100 border-transparent",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-4 focus:ring-red-100 border-transparent",ghost:"text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:ring-4 focus:ring-gray-100"},buttonSize:{xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"},badge:{primary:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-amber-100 text-amber-800",danger:"bg-red-100 text-red-800",info:"bg-sky-100 text-sky-800"},input:{base:"w-full rounded-lg border px-3 py-2 text-sm shadow-sm transition-colors focus:outline-none focus:ring-4",default:"border-gray-200 bg-white text-gray-900 placeholder:text-gray-400 focus:border-blue-500 focus:ring-blue-100",error:"border-red-300 bg-red-50 text-red-900 placeholder:text-red-300 focus:border-red-500 focus:ring-red-100",success:"border-green-300 bg-green-50 text-green-900 placeholder:text-green-300 focus:border-green-500 focus:ring-green-100",disabled:"border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed"}},De={transition:{fast:"transition-all duration-150 ease-in-out"}},pe=(...e)=>e.filter(Boolean).join(" "),he=(e,s,n=null)=>{const o=le[e];if(!o)return"";let r=o[s]||o.default||"";return n&&le[`${e}Size`]&&(r+=" "+le[`${e}Size`][n]),r},Me=["type","disabled"],je={key:0,class:"inline-flex items-center"},_e={key:1},Q={__name:"BaseButton",props:{type:{type:String,default:"button"},variant:{type:String,default:"primary",validator:e=>["primary","secondary","danger","success","warning","ghost"].includes(e)},size:{type:String,default:"md",validator:e=>["xs","sm","md","lg","xl"].includes(e)},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"Cargando..."},block:{type:Boolean,default:!1}},emits:["click"],setup(e){const s=e,n=j(()=>pe("inline-flex items-center justify-center font-medium rounded-lg border focus:outline-none focus:ring-4 disabled:opacity-50 disabled:cursor-not-allowed",De.transition.fast,he("button",s.variant,s.size),s.block&&"w-full"));return(o,r)=>(d(),u("button",{type:e.type,disabled:e.disabled||e.loading,class:K(n.value),onClick:r[0]||(r[0]=a=>o.$emit("click",a))},[e.loading?(d(),u("span",je,[r[1]||(r[1]=t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),D(" "+x(e.loadingText),1)])):(d(),u("span",_e,[C(o.$slots,"default")]))],10,Me))}},Ie={class:"flex items-center justify-between"},Oe={class:"text-sm font-semibold text-gray-900 dark:text-slate-100"},Ue={key:0,class:"mt-1 text-xs text-gray-600 dark:text-slate-300"},qe={class:"flex items-center gap-3"},Fe={key:0,class:"text-xs text-gray-600 dark:text-slate-300"},Ve={key:0,class:"p-4 border-b border-gray-200 dark:border-slate-800"},Le={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Qe={key:0,class:"flex-1"},Ke=["for"],Ge=["id","value","placeholder"],He={class:"flex items-center gap-2"},We=["value"],Je=["value"],Re={key:0,class:"mt-4"},Ne={key:1,class:"p-4 border-b border-red-200 bg-red-50 dark:border-red-900/40 dark:bg-red-950/30"},Xe={class:"text-sm text-red-700 dark:text-red-200"},Ye={class:"overflow-x-auto"},Ze={class:"text-xs uppercase bg-gray-50 text-gray-700 dark:bg-slate-800 dark:text-slate-200"},et={class:"flex items-center gap-2"},tt=["onClick"],st={key:0},rt=["colspan"],at={key:1},ot=["colspan"],nt={key:2,class:"p-4 border-t border-gray-200 dark:border-slate-800"},lt={class:"flex items-center justify-between gap-3"},it={class:"text-xs text-gray-600 dark:text-slate-300"},ct={__name:"GenericTable",props:{tableId:{type:String,default:()=>`table-${Date.now()}`},title:{type:String,required:!0},subtitle:{type:String,default:""},columns:{type:Array,required:!0,validator:e=>e.every(s=>s.key&&s.label)},items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},pagination:{type:Object,default:()=>({current_page:1,last_page:1,total:0,from:null,to:null})},showPagination:{type:Boolean,default:!0},paginationInfo:{type:String,default:""},searchable:{type:Boolean,default:!0},searchQuery:{type:String,default:""},searchPlaceholder:{type:String,default:"Buscar..."},sortable:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!0},showPerPageSelector:{type:Boolean,default:!0},perPage:{type:Number,default:25},perPageOptions:{type:Array,default:()=>[10,15,25,50]},tableClass:{type:String,default:""},emptyMessage:{type:String,default:"No hay datos para mostrar"},rowKey:{type:[String,Function],default:"id"}},emits:["search","sort","page-change","per-page-change"],setup(e){const s=e,n=j(()=>!s.loading&&s.items.length===0),o=(r,a)=>typeof s.rowKey=="function"?s.rowKey(r,a):r[s.rowKey]||a;return(r,a)=>(d(),me(ze,{title:e.title,subtitle:e.subtitle,"no-padding":""},{header:A(()=>[t("div",Ie,[t("div",null,[t("h3",Oe,x(e.title),1),e.paginationInfo?(d(),u("p",Ue,x(e.paginationInfo),1)):y("",!0)]),t("div",qe,[C(r.$slots,"headerActions"),e.loading?(d(),u("div",Fe,"Cargando…")):y("",!0)])])]),default:A(()=>[e.showFilters?(d(),u("div",Ve,[t("div",Le,[e.searchable?(d(),u("div",Qe,[t("label",{class:"sr-only",for:`${e.tableId}-search`},"Buscar",8,Ke),t("input",{id:`${e.tableId}-search`,value:e.searchQuery,type:"search",placeholder:e.searchPlaceholder,class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-400 shadow-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-100 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500",onInput:a[0]||(a[0]=l=>r.$emit("search",l.target.value))},null,40,Ge)])):y("",!0),t("div",He,[C(r.$slots,"filters"),e.showPerPageSelector?(d(),u("select",{key:0,value:e.perPage,class:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-100 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100",onChange:a[1]||(a[1]=l=>r.$emit("per-page-change",Number(l.target.value)))},[(d(!0),u(Z,null,te(e.perPageOptions,l=>(d(),u("option",{key:l,value:l},x(l),9,Je))),128))],40,We)):y("",!0)])]),r.$slots.secondaryFilters?(d(),u("div",Re,[C(r.$slots,"secondaryFilters")])):y("",!0)])):y("",!0),e.error?(d(),u("div",Ne,[t("div",Xe,x(e.error),1)])):y("",!0),t("div",Ye,[t("table",{class:K(["w-full text-sm text-left text-gray-700 dark:text-slate-200",e.tableClass])},[t("thead",Ze,[t("tr",null,[(d(!0),u(Z,null,te(e.columns,l=>(d(),u("th",{key:l.key,class:K(["px-4 py-3",l.headerClass])},[t("div",et,[D(x(l.label)+" ",1),l.sortable&&e.sortable?(d(),u("button",{key:0,type:"button",class:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300",onClick:p=>r.$emit("sort",l.key)},[...a[4]||(a[4]=[t("svg",{class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M5 12l5 5 5-5H5z"})],-1)])],8,tt)):y("",!0)])],2))),128))])]),t("tbody",null,[(d(!0),u(Z,null,te(e.items,(l,p)=>C(r.$slots,"row",{key:o(l,p),item:l,index:p,columns:e.columns})),128)),n.value?(d(),u("tr",st,[t("td",{colspan:e.columns.length,class:"px-4 py-10 text-center text-sm text-gray-600 dark:text-slate-300"},[C(r.$slots,"empty",{},()=>[D(x(e.emptyMessage),1)])],8,rt)])):y("",!0),e.loading&&e.items.length===0?(d(),u("tr",at,[t("td",{colspan:e.columns.length,class:"px-4 py-10 text-center text-sm text-gray-600 dark:text-slate-300"},[...a[5]||(a[5]=[t("div",{class:"flex items-center justify-center gap-2"},[t("svg",{class:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),D(" Cargando… ")],-1)])],8,ot)])):y("",!0)])],2)]),e.showPagination&&e.pagination&&e.pagination.last_page>1?(d(),u("div",nt,[t("div",lt,[O(Q,{variant:"secondary",size:"sm",disabled:e.loading||e.pagination.current_page<=1,onClick:a[2]||(a[2]=l=>r.$emit("page-change",e.pagination.current_page-1))},{default:A(()=>[...a[6]||(a[6]=[D(" Anterior ",-1)])]),_:1},8,["disabled"]),t("div",it,[C(r.$slots,"paginationInfo",{},()=>[D(" Página "+x(e.pagination.current_page)+" / "+x(e.pagination.last_page),1)])]),O(Q,{variant:"secondary",size:"sm",disabled:e.loading||e.pagination.current_page>=e.pagination.last_page,onClick:a[3]||(a[3]=l=>r.$emit("page-change",e.pagination.current_page+1))},{default:A(()=>[...a[7]||(a[7]=[D(" Siguiente ",-1)])]),_:1},8,["disabled"])])])):y("",!0)]),_:3},8,["title","subtitle"]))}};function dt(e={}){const{closeOnEscape:s=!0,closeOnBackdrop:n=!0,preventBodyScroll:o=!0}=e,r=_(!1),a=_(!1),l=()=>{r.value=!0,o&&(document.body.style.overflow="hidden")},p=()=>{a.value||(a.value=!0,setTimeout(()=>{r.value=!1,a.value=!1,o&&(document.body.style.overflow="")},150))},B=()=>{r.value?p():l()},M=m=>{s&&m.key==="Escape"&&r.value&&p()},I=m=>{n&&m.target===m.currentTarget&&p()};return be(()=>{s&&document.addEventListener("keydown",M)}),$e(()=>{s&&document.removeEventListener("keydown",M),o&&r.value&&(document.body.style.overflow="")}),{isOpen:r,isAnimating:a,open:l,close:p,toggle:B,handleBackdrop:I}}const ut={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},gt={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-6"},ft={key:0,class:"px-6 py-4 border-b border-gray-200 dark:border-slate-700"},mt={class:"flex items-center justify-between"},bt={class:"flex-1"},yt={class:"text-lg font-semibold leading-6 text-gray-900 dark:text-slate-100",id:"modal-title"},pt={key:0,class:"mt-1 text-sm text-gray-600 dark:text-slate-400"},ht={class:"px-6 py-4 bg-white dark:bg-slate-900 max-h-[70vh] overflow-y-auto"},xt={key:1,class:"px-6 py-4 bg-gray-50 border-t border-gray-200 dark:bg-slate-800 dark:border-slate-700"},vt={__name:"BaseModal",props:{title:{type:String,default:""},subtitle:{type:String,default:""},maxWidth:{type:String,default:"2xl",validator:e=>["sm","md","lg","xl","2xl","3xl","4xl","5xl","6xl"].includes(e)},showCloseButton:{type:Boolean,default:!0},closeOnEscape:{type:Boolean,default:!0},closeOnBackdrop:{type:Boolean,default:!0}},emits:["close","open"],setup(e,{expose:s,emit:n}){const o=e,r=n,a={sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl","3xl":"sm:max-w-3xl","4xl":"sm:max-w-4xl","5xl":"sm:max-w-5xl","6xl":"sm:max-w-6xl"},l=j(()=>a[o.maxWidth]||a["2xl"]),{isOpen:p,isAnimating:B,open:M,close:I,handleBackdrop:m}=dt({closeOnEscape:o.closeOnEscape,closeOnBackdrop:o.closeOnBackdrop}),S=()=>{M(),r("open")},z=()=>{I(),r("close")};return s({open:S,close:z,isOpen:p}),(E,b)=>h(p)?(d(),u("div",ut,[t("div",{class:K(["fixed inset-0 bg-gray-500/75 transition-opacity dark:bg-gray-900/80",{"opacity-100":!h(B),"opacity-0":h(B)}]),onClick:b[0]||(b[0]=(...U)=>h(m)&&h(m)(...U))},null,2),t("div",gt,[t("div",{class:K(["relative w-full transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all dark:bg-slate-900",[l.value,{"translate-y-0 opacity-100 sm:scale-100":!h(B),"translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95":h(B)}]])},[E.$slots.header||e.title?(d(),u("div",ft,[t("div",mt,[t("div",bt,[C(E.$slots,"header",{},()=>[t("h3",yt,x(e.title),1),e.subtitle?(d(),u("p",pt,x(e.subtitle),1)):y("",!0)])]),e.showCloseButton?(d(),u("button",{key:0,type:"button",class:"ml-4 rounded-md bg-white text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-slate-900 dark:hover:text-slate-300 p-2",onClick:z},[...b[1]||(b[1]=[t("span",{class:"sr-only"},"Cerrar",-1),t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])):y("",!0)])])):y("",!0),t("div",ht,[C(E.$slots,"default")]),E.$slots.footer?(d(),u("div",xt,[C(E.$slots,"footer")])):y("",!0)],2)])])):y("",!0)}},kt={__name:"BaseBadge",props:{variant:{type:String,default:"secondary",validator:e=>["primary","secondary","success","warning","danger","info"].includes(e)},size:{type:String,default:"sm",validator:e=>["xs","sm","md"].includes(e)},rounded:{type:Boolean,default:!1}},setup(e){const s=e,n=j(()=>{const o={xs:"px-1.5 py-0.5 text-xs",sm:"px-2 py-1 text-xs",md:"px-2.5 py-1.5 text-sm"};return pe("inline-flex items-center font-medium",s.rounded?"rounded-full":"rounded-md",o[s.size],he("badge",s.variant))});return(o,r)=>(d(),u("span",{class:K(n.value)},[C(o.$slots,"default")],2))}};function wt(e={}){const{endpoint:s,columns:n=[],defaultFilters:o={},actions:r={},defaultPerPage:a=25,searchDebounce:l=300,transformData:p=null,onError:B=null}=e,M=_(!1),I=_(null),m=_([]),S=_([]),z=ae({current_page:1,last_page:1,per_page:a,total:0,from:null,to:null}),E=ae({q:"",page:1,per_page:a,sort_by:null,sort_direction:"asc",...o}),b=ae({sortColumn:null,sortDirection:"asc",searchQuery:"",processing:new Set}),U=j(()=>m.value.length>0),P=j(()=>!M.value&&m.value.length===0),G=j(()=>z.total||0),R=j(()=>{if(!z.total)return"";const i=z.from||0,f=z.to||0,F=z.total||0;return`${i}-${f} de ${F}`}),H=j(()=>S.value.length>0),$=j(()=>U.value&&m.value.every(i=>S.value.includes(i.id))),W=async(i={})=>{var f,F,V;if(!s){console.error("useGenericTable: endpoint is required");return}M.value=!0,I.value=null;try{const T={...E,...i},w=await J.get(s,{params:T});let g=((f=w.data)==null?void 0:f.data)||w.data;p&&typeof p=="function"&&(g=p(g)),m.value=(g==null?void 0:g.items)||g||[],g!=null&&g.pagination&&Object.assign(z,g.pagination)}catch(T){const w=((V=(F=T.response)==null?void 0:F.data)==null?void 0:V.message)||"Error al cargar los datos";I.value=w,B&&typeof B=="function"?B(T,w):console.error("Table fetch error:",T)}finally{M.value=!1}},L=async(i={})=>{Object.assign(E,i),await W()},se=async i=>{await L({page:i})},ee=async i=>{await L({per_page:i,page:1})},N=async i=>{b.searchQuery=i,await L({q:i,page:1})},v=async i=>{let f="asc";b.sortColumn===i&&(f=b.sortDirection==="asc"?"desc":"asc"),b.sortColumn=i,b.sortDirection=f,await L({sort_by:i,sort_direction:f,page:1})},c=async()=>{await W()},k=async()=>{Object.assign(E,{q:"",page:1,per_page:a,sort_by:null,sort_direction:"asc",...o}),b.sortColumn=null,b.sortDirection="asc",b.searchQuery="",await W()},X=i=>{S.value.includes(i)||S.value.push(i)},q=i=>{const f=S.value.indexOf(i);f>-1&&S.value.splice(f,1)},xe=i=>{S.value.includes(i)?q(i):X(i)},ie=()=>{S.value=m.value.map(i=>i.id)},ce=()=>{S.value=[]},ve=()=>{$.value?ce():ie()},de=async(i,f,F=null)=>{var V,T;if(!r[i])return console.error(`Action '${i}' is not defined`),!1;b.processing.add(f);try{const w=await r[i](f,F);if(i==="delete"){const g=m.value.findIndex(re=>re.id===f);g>-1&&m.value.splice(g,1),q(f)}else if(w!=null&&w.data){const g=m.value.findIndex(re=>re.id===f);g>-1&&(m.value[g]={...m.value[g],...w.data})}return w}catch(w){const g=((T=(V=w.response)==null?void 0:V.data)==null?void 0:T.message)||`Error en acción ${i}`;throw I.value=g,w}finally{b.processing.delete(f)}},ke=async(i,f,F=null)=>{const V=[],T=[];for(const w of f)try{const g=await de(i,w,F);V.push({id:w,result:g})}catch(g){T.push({id:w,error:g})}return T.length>0&&console.error("Bulk action errors:",T),{results:V,errors:T}},we=i=>b.processing.has(i);let ue;const ge=i=>{clearTimeout(ue),ue=setTimeout(()=>{N(i)},l)};return ye(()=>b.searchQuery,(i,f)=>{i!==f&&ge(i)}),{loading:M,error:I,items:m,pagination:z,filters:E,tableState:b,selectedItems:S,hasData:U,isEmpty:P,totalCount:G,paginationInfo:R,hasSelectedItems:H,allItemsSelected:$,fetchData:W,applyFilters:L,changePage:se,changePerPage:ee,handleSearch:N,handleSort:v,refresh:c,reset:k,selectItem:X,unselectItem:q,toggleSelection:xe,selectAll:ie,unselectAll:ce,toggleSelectAll:ve,performAction:de,bulkAction:ke,isProcessing:we,debouncedSearch:ge}}class $t{constructor(s){this.baseEndpoint=s}async create(s){try{return(await J.post(this.baseEndpoint,s)).data}catch(n){throw n}}async update(s,n){try{return(await J.patch(`${this.baseEndpoint}/${s}`,n)).data}catch(o){throw o}}async delete(s){try{return(await J.delete(`${this.baseEndpoint}/${s}`)).data}catch(n){throw n}}async archive(s){try{return(await J.patch(`${this.baseEndpoint}/${s}/archive`)).data}catch(n){throw n}}async restore(s){try{return(await J.patch(`${this.baseEndpoint}/${s}/restore`)).data}catch(n){throw n}}getSweetAlertTheme(){return document.documentElement.classList.contains("dark")?{background:"#0f172a",color:"#f1f5f9",confirmButtonColor:"#ef4444",cancelButtonColor:"#64748b"}:{background:"#ffffff",color:"#1e293b",confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280"}}async confirmDelete(s,n=null){const o=n||`Se eliminará permanentemente "${s}"`,r=this.getSweetAlertTheme();return(await Y.fire({title:"¿Eliminar elemento?",text:o,icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:r.confirmButtonColor,cancelButtonColor:r.cancelButtonColor,background:r.background,color:r.color,reverseButtons:!0})).isConfirmed}async confirmArchive(s,n=null){const o=n||`Se archivará "${s}"`,r=this.getSweetAlertTheme();return(await Y.fire({title:"¿Archivar elemento?",text:o,icon:"question",showCancelButton:!0,confirmButtonText:"Sí, archivar",cancelButtonText:"Cancelar",confirmButtonColor:"#f59e0b",cancelButtonColor:r.cancelButtonColor,background:r.background,color:r.color,reverseButtons:!0})).isConfirmed}async confirmBulkAction(s,n){const o=this.getSweetAlertTheme(),a={delete:{title:"¿Eliminar elementos?",text:`Se eliminarán ${n} elementos permanentemente`,confirmText:"Sí, eliminar todos",color:"#ef4444"},archive:{title:"¿Archivar elementos?",text:`Se archivarán ${n} elementos`,confirmText:"Sí, archivar todos",color:"#f59e0b"}}[s];return a?(await Y.fire({title:a.title,text:a.text,icon:"warning",showCancelButton:!0,confirmButtonText:a.confirmText,cancelButtonText:"Cancelar",confirmButtonColor:a.color,cancelButtonColor:o.cancelButtonColor,background:o.background,color:o.color,reverseButtons:!0})).isConfirmed:!1}showSuccess(s,n="¡Éxito!"){const o=this.getSweetAlertTheme();Y.fire({title:n,text:s,icon:"success",timer:2e3,showConfirmButton:!1,background:o.background,color:o.color})}showError(s,n="Error"){const o=this.getSweetAlertTheme();Y.fire({title:n,text:s,icon:"error",background:o.background,color:o.color})}async bulkDelete(s){try{const n=s.map(l=>this.delete(l)),o=await Promise.allSettled(n),r=o.filter(l=>l.status==="fulfilled").length,a=o.filter(l=>l.status==="rejected").length;return a===0?this.showSuccess(`${r} elementos eliminados correctamente`):this.showError(`${r} elementos eliminados, ${a} fallaron`),{successful:r,failed:a}}catch(n){throw n}}async bulkArchive(s){try{const n=s.map(l=>this.archive(l)),o=await Promise.allSettled(n),r=o.filter(l=>l.status==="fulfilled").length,a=o.filter(l=>l.status==="rejected").length;return a===0?this.showSuccess(`${r} elementos archivados correctamente`):this.showError(`${r} elementos archivados, ${a} fallaron`),{successful:r,failed:a}}catch(n){throw n}}}function Ct(e){return new $t(e)}function Bt(e){const s=Ct(e);return{actions:s,performAction:async(r,a,l=null,p="")=>{switch(r){case"delete":return await s.confirmDelete(p)?(await s.delete(a),s.showSuccess("Elemento eliminado correctamente"),!0):!1;case"archive":return await s.confirmArchive(p)?(await s.archive(a),s.showSuccess("Elemento archivado correctamente"),!0):!1;case"update":return await s.update(a,l),s.showSuccess("Elemento actualizado correctamente"),!0;case"create":const B=await s.create(l);return s.showSuccess("Elemento creado correctamente"),B;default:throw new Error(`Action '${r}' not supported`)}},performBulkAction:async(r,a)=>{if(!a.length||!await s.confirmBulkAction(r,a.length))return!1;switch(r){case"delete":return await s.bulkDelete(a);case"archive":return await s.bulkArchive(a);default:throw new Error(`Bulk action '${r}' not supported`)}}}}const St={class:"border-b border-gray-100 bg-white hover:bg-blue-50/40 transition-colors dark:border-slate-800 dark:bg-slate-900 dark:hover:bg-slate-800/60"},At={class:"px-4 py-3 font-medium text-gray-900 dark:text-slate-100"},Et={class:"px-4 py-3"},Pt={class:"flex items-center gap-3"},Tt={class:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center dark:bg-blue-900"},zt={class:"text-sm font-medium text-blue-600 dark:text-blue-300"},Dt={class:"font-medium text-gray-900 dark:text-slate-100"},Mt={class:"text-sm text-gray-500 dark:text-slate-400"},jt={class:"px-4 py-3"},_t={class:"flex flex-wrap gap-1"},It={class:"px-4 py-3 text-sm text-gray-500 dark:text-slate-400"},Ot={class:"px-4 py-3"},Ut={class:"flex items-center gap-2"},qt={class:"py-2"},Ft={class:"grid grid-cols-1 gap-5"},Vt={class:"space-y-5"},Lt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Qt={key:0,class:"space-y-3"},Kt={class:"flex items-center justify-between pt-4"},Gt={class:"flex items-center gap-3"},Ht={class:"flex items-center justify-center"},Wt={key:0,class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xt={__name:"UsersTable",setup(e){const s=[{key:"id",label:"ID",sortable:!0},{key:"name",label:"Usuario",sortable:!0},{key:"roles",label:"Roles"},{key:"created_at",label:"Creado",sortable:!0},{key:"actions",label:"Acciones"}],{loading:n,error:o,items:r,pagination:a,filters:l,tableState:p,paginationInfo:B,fetchData:M,changePage:I,changePerPage:m,handleSearch:S,handleSort:z,isProcessing:E,refresh:b}=wt({endpoint:"/users/data",defaultFilters:{},actions:{},defaultPerPage:25}),{performAction:U}=Bt("/users"),P=_(null),G=_(!1),R=_(!1),H=_(null),$=_({name:"",email:"",password:""}),W=v=>v?new Date(v).toLocaleString("es-ES"):"",L=v=>{var c;P.value=v,$.value={name:v.name,email:v.email,password:""},(c=H.value)==null||c.open()},se=async v=>{await U("delete",v.id,null,v.name)&&b()},ee=async()=>{G.value=!0;try{P.value?await U("update",P.value.id,$.value):await U("create",null,$.value),N(),b()}catch(v){console.error("Error saving user:",v)}finally{G.value=!1}},N=()=>{var v;P.value=null,$.value={name:"",email:"",password:""},(v=H.value)==null||v.close(),fe(()=>{R.value=!1})};return ye(()=>R.value,v=>{v&&($.value={name:"",email:"",password:""},P.value=null,fe(()=>{var c;(c=H.value)==null||c.open()}))}),be(async()=>{await M()}),(v,c)=>(d(),u(Z,null,[O(ct,{"table-id":"users-table",title:"Usuarios",columns:s,items:h(r),loading:h(n),error:h(o),pagination:h(a),"pagination-info":h(B),"search-query":h(p).searchQuery,"search-placeholder":"Buscar por nombre o email","per-page":h(l).per_page,"per-page-options":[10,25,50,100],sortable:"",onSearch:h(S),onSort:h(z),onPageChange:h(I),onPerPageChange:h(m)},{headerActions:A(()=>[O(Q,{variant:"primary",onClick:c[0]||(c[0]=k=>R.value=!0)},{default:A(()=>[...c[4]||(c[4]=[D(" Crear Usuario ",-1)])]),_:1})]),row:A(({item:k})=>{var X;return[t("tr",St,[t("td",At,x(k.id),1),t("td",Et,[t("div",Pt,[t("div",Tt,[t("span",zt,x((X=k.name)==null?void 0:X.charAt(0).toUpperCase()),1)]),t("div",null,[t("div",Dt,x(k.name),1),t("div",Mt,x(k.email),1)])])]),t("td",jt,[t("div",_t,[(d(!0),u(Z,null,te(k.roles,q=>(d(),me(kt,{key:q.id,variant:"primary",size:"xs",rounded:""},{default:A(()=>[D(x(q.name),1)]),_:2},1024))),128))])]),t("td",It,x(W(k.created_at)),1),t("td",Ot,[t("div",Ut,[O(Q,{variant:"ghost",size:"sm",loading:h(E)(k.id),onClick:q=>L(k)},{default:A(()=>[...c[5]||(c[5]=[D(" Editar ",-1)])]),_:1},8,["loading","onClick"]),O(Q,{variant:"ghost",size:"sm",loading:h(E)(k.id),onClick:q=>se(k)},{default:A(()=>[...c[6]||(c[6]=[D(" Eliminar ",-1)])]),_:1},8,["loading","onClick"])])])])]}),_:1},8,["items","loading","error","pagination","pagination-info","search-query","per-page","onSearch","onSort","onPageChange","onPerPageChange"]),O(vt,{ref_key:"userModal",ref:H,title:P.value?"Editar Usuario":"Crear Usuario",subtitle:P.value?`Modificar datos de ${P.value.name}`:"Agregar nuevo usuario al sistema","max-width":"xl","close-on-backdrop":""},{footer:A(()=>[t("div",Kt,[c[15]||(c[15]=t("div",{class:"text-xs text-gray-500 dark:text-slate-400"}," * Campos obligatorios ",-1)),t("div",Gt,[O(Q,{variant:"secondary",size:"sm",onClick:N},{default:A(()=>[...c[13]||(c[13]=[D(" Cancelar ",-1)])]),_:1}),O(Q,{variant:"primary",size:"sm",loading:G.value,disabled:!$.value.name||!$.value.email||!P.value&&!$.value.password,onClick:ee},{default:A(()=>[t("div",Ht,[G.value?y("",!0):(d(),u("svg",Wt,[...c[14]||(c[14]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),t("span",null,x(P.value?"Actualizar":"Crear"),1)])]),_:1},8,["loading","disabled"])])])]),default:A(()=>[t("div",qt,[t("form",{onSubmit:Ce(ee,["prevent"])},[t("div",Ft,[t("div",Vt,[c[12]||(c[12]=t("div",{class:"border-b border-gray-200 dark:border-slate-700 pb-3"},[t("h4",{class:"text-base font-semibold text-gray-900 dark:text-slate-100"},"Información Personal"),t("p",{class:"text-sm text-gray-600 dark:text-slate-400"},"Datos básicos del usuario")],-1)),t("div",Lt,[t("div",null,[c[7]||(c[7]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2"}," Nombre completo * ",-1)),oe(t("input",{"onUpdate:modelValue":c[1]||(c[1]=k=>$.value.name=k),type:"text",required:"",placeholder:"Ej: Juan Carlos Pérez",class:"block w-full rounded-lg border border-gray-300 px-3 py-2.5 text-sm shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-100 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100 dark:placeholder:text-slate-400 dark:focus:border-blue-500 dark:focus:ring-blue-500/20"},null,512),[[ne,$.value.name]])]),t("div",null,[c[8]||(c[8]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2"}," Correo electrónico * ",-1)),oe(t("input",{"onUpdate:modelValue":c[2]||(c[2]=k=>$.value.email=k),type:"email",required:"",placeholder:"usuario@empresa.com",class:"block w-full rounded-lg border border-gray-300 px-3 py-2.5 text-sm shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-100 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100 dark:placeholder:text-slate-400 dark:focus:border-blue-500 dark:focus:ring-blue-500/20"},null,512),[[ne,$.value.email]])])]),P.value?y("",!0):(d(),u("div",Qt,[c[11]||(c[11]=t("div",{class:"border-b border-gray-200 dark:border-slate-700 pb-3"},[t("h4",{class:"text-base font-semibold text-gray-900 dark:text-slate-100"},"Configuración de Acceso"),t("p",{class:"text-sm text-gray-600 dark:text-slate-400"},"Contraseña para el nuevo usuario")],-1)),t("div",null,[c[9]||(c[9]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2"}," Contraseña * ",-1)),oe(t("input",{"onUpdate:modelValue":c[3]||(c[3]=k=>$.value.password=k),type:"password",required:"",placeholder:"Mínimo 8 caracteres",class:"block w-full rounded-lg border border-gray-300 px-3 py-2.5 text-sm shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-100 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100 dark:placeholder:text-slate-400 dark:focus:border-blue-500 dark:focus:ring-blue-500/20"},null,512),[[ne,$.value.password]]),c[10]||(c[10]=t("p",{class:"mt-2 text-xs text-gray-500 dark:text-slate-400"}," La contraseña debe tener al menos 8 caracteres ",-1))])]))])])],32)])]),_:1},8,["title","subtitle"])],64))}};export{Xt as default};
