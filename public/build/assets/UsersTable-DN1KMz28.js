import{e as U,g as m,i as f,k,j as e,E as I,t as v,n as ce,q as he,A as $,F as Z,m as ae,z,B as M,r as D,G as ge,H as ye,I as be,o as ve,u as P,l as xe,w as ie,x as me,D as ke}from"./vendor-vue-Db-AqoDh.js";import{a as Q}from"./vendor-utils-Czy7fllw.js";import{S as K}from"./vendor-ui-DEm6YKEA.js";import{_ as H,c as we,g as $e,a as Ce}from"./BaseModal-DiudK4Y3.js";const Se={class:"bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-slate-900 dark:border-slate-800"},Be={key:0,class:"p-4 border-b border-gray-200 dark:border-slate-800"},Ae={class:"flex items-center justify-between"},Pe={class:"text-sm font-semibold text-gray-900 dark:text-slate-100"},_e={key:0,class:"mt-1 text-xs text-gray-600 dark:text-slate-300"},Ee={key:1,class:"p-4 border-t border-gray-200 dark:border-slate-800"},Te={__name:"BaseCard",props:{title:{type:String,default:""},subtitle:{type:String,default:""},padding:{type:Boolean,default:!0},noPadding:{type:Boolean,default:!1}},setup(a){const t=a,l=U(()=>t.noPadding||!t.padding?"":"p-4");return(i,o)=>(f(),m("div",Se,[i.$slots.header||a.title?(f(),m("div",Be,[I(i.$slots,"header",{},()=>[e("div",Ae,[e("div",null,[e("h3",Pe,v(a.title),1),a.subtitle?(f(),m("p",_e,v(a.subtitle),1)):k("",!0)]),I(i.$slots,"headerActions")])])])):k("",!0),e("div",{class:ce(l.value)},[I(i.$slots,"default")],2),i.$slots.footer?(f(),m("div",Ee,[I(i.$slots,"footer")])):k("",!0)]))}},De={class:"flex items-center justify-between"},je={class:"text-sm font-semibold text-gray-900 dark:text-slate-100"},Ie={key:0,class:"mt-1 text-xs text-gray-600 dark:text-slate-300"},ze={class:"flex items-center gap-3"},Fe={key:0,class:"text-xs text-gray-600 dark:text-slate-300"},Me={key:0,class:"p-4 border-b border-gray-200 dark:border-slate-800"},Ue={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},qe={key:0,class:"flex-1"},Oe=["for"],Re=["id","value","placeholder"],Ve={class:"flex items-center gap-2"},Qe=["value"],Ge=["value"],Le={key:0,class:"mt-4"},Ke={key:1,class:"p-4 border-b border-red-200 bg-red-50 dark:border-red-900/40 dark:bg-red-950/30"},He={class:"text-sm text-red-700 dark:text-red-200"},Je={class:"overflow-x-auto"},Ne={class:"text-xs uppercase bg-gray-50 text-gray-700 dark:bg-slate-800 dark:text-slate-200"},We={class:"flex items-center gap-2"},Xe=["onClick"],Ye={key:0},Ze=["colspan"],et={key:1},tt=["colspan"],at={key:2,class:"p-4 border-t border-gray-200 dark:border-slate-800"},st={class:"flex items-center justify-between gap-3"},rt={class:"text-xs text-gray-600 dark:text-slate-300"},ot={__name:"GenericTable",props:{tableId:{type:String,default:()=>`table-${Date.now()}`},title:{type:String,required:!0},subtitle:{type:String,default:""},columns:{type:Array,required:!0,validator:a=>a.every(t=>t.key&&t.label)},items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},pagination:{type:Object,default:()=>({current_page:1,last_page:1,total:0,from:null,to:null})},showPagination:{type:Boolean,default:!0},paginationInfo:{type:String,default:""},searchable:{type:Boolean,default:!0},searchQuery:{type:String,default:""},searchPlaceholder:{type:String,default:"Buscar..."},sortable:{type:Boolean,default:!1},showFilters:{type:Boolean,default:!0},showPerPageSelector:{type:Boolean,default:!0},perPage:{type:Number,default:25},perPageOptions:{type:Array,default:()=>[10,15,25,50]},tableClass:{type:String,default:""},emptyMessage:{type:String,default:"No hay datos para mostrar"},rowKey:{type:[String,Function],default:"id"}},emits:["search","sort","page-change","per-page-change"],setup(a){const t=a,l=U(()=>!t.loading&&t.items.length===0),i=(o,r)=>typeof t.rowKey=="function"?t.rowKey(o,r):o[t.rowKey]||r;return(o,r)=>(f(),he(Te,{title:a.title,subtitle:a.subtitle,"no-padding":""},{header:$(()=>[e("div",De,[e("div",null,[e("h3",je,v(a.title),1),a.paginationInfo?(f(),m("p",Ie,v(a.paginationInfo),1)):k("",!0)]),e("div",ze,[I(o.$slots,"headerActions"),a.loading?(f(),m("div",Fe,"Cargando…")):k("",!0)])])]),default:$(()=>[a.showFilters?(f(),m("div",Me,[e("div",Ue,[a.searchable?(f(),m("div",qe,[e("label",{class:"sr-only",for:`${a.tableId}-search`},"Buscar",8,Oe),e("input",{id:`${a.tableId}-search`,value:a.searchQuery,type:"search",placeholder:a.searchPlaceholder,class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-400 shadow-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-100 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500",onInput:r[0]||(r[0]=c=>o.$emit("search",c.target.value))},null,40,Re)])):k("",!0),e("div",Ve,[I(o.$slots,"filters"),a.showPerPageSelector?(f(),m("select",{key:0,value:a.perPage,class:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-blue-500 focus:ring-4 focus:ring-blue-100 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100",onChange:r[1]||(r[1]=c=>o.$emit("per-page-change",Number(c.target.value)))},[(f(!0),m(Z,null,ae(a.perPageOptions,c=>(f(),m("option",{key:c,value:c},v(c),9,Ge))),128))],40,Qe)):k("",!0)])]),o.$slots.secondaryFilters?(f(),m("div",Le,[I(o.$slots,"secondaryFilters")])):k("",!0)])):k("",!0),a.error?(f(),m("div",Ke,[e("div",He,v(a.error),1)])):k("",!0),e("div",Je,[e("table",{class:ce(["w-full text-sm text-left text-gray-700 dark:text-slate-200",a.tableClass])},[e("thead",Ne,[e("tr",null,[(f(!0),m(Z,null,ae(a.columns,c=>(f(),m("th",{key:c.key,class:ce(["px-4 py-3",c.headerClass])},[e("div",We,[z(v(c.label)+" ",1),c.sortable&&a.sortable?(f(),m("button",{key:0,type:"button",class:"text-gray-400 hover:text-gray-600 dark:hover:text-slate-300",onClick:C=>o.$emit("sort",c.key)},[...r[4]||(r[4]=[e("svg",{class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M5 12l5 5 5-5H5z"})],-1)])],8,Xe)):k("",!0)])],2))),128))])]),e("tbody",null,[(f(!0),m(Z,null,ae(a.items,(c,C)=>I(o.$slots,"row",{key:i(c,C),item:c,index:C,columns:a.columns})),128)),l.value?(f(),m("tr",Ye,[e("td",{colspan:a.columns.length,class:"px-4 py-10 text-center text-sm text-gray-600 dark:text-slate-300"},[I(o.$slots,"empty",{},()=>[z(v(a.emptyMessage),1)])],8,Ze)])):k("",!0),a.loading&&a.items.length===0?(f(),m("tr",et,[e("td",{colspan:a.columns.length,class:"px-4 py-10 text-center text-sm text-gray-600 dark:text-slate-300"},[...r[5]||(r[5]=[e("div",{class:"flex items-center justify-center gap-2"},[e("svg",{class:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),z(" Cargando… ")],-1)])],8,tt)])):k("",!0)])],2)]),a.showPagination&&a.pagination&&a.pagination.last_page>1?(f(),m("div",at,[e("div",st,[M(H,{variant:"secondary",size:"sm",disabled:a.loading||a.pagination.current_page<=1,onClick:r[2]||(r[2]=c=>o.$emit("page-change",a.pagination.current_page-1))},{default:$(()=>[...r[6]||(r[6]=[z(" Anterior ",-1)])]),_:1},8,["disabled"]),e("div",rt,[I(o.$slots,"paginationInfo",{},()=>[z(" Página "+v(a.pagination.current_page)+" / "+v(a.pagination.last_page),1)])]),M(H,{variant:"secondary",size:"sm",disabled:a.loading||a.pagination.current_page>=a.pagination.last_page,onClick:r[3]||(r[3]=c=>o.$emit("page-change",a.pagination.current_page+1))},{default:$(()=>[...r[7]||(r[7]=[z(" Siguiente ",-1)])]),_:1},8,["disabled"])])])):k("",!0)]),_:3},8,["title","subtitle"]))}},lt={__name:"BaseBadge",props:{variant:{type:String,default:"secondary",validator:a=>["primary","secondary","success","warning","danger","info"].includes(a)},size:{type:String,default:"sm",validator:a=>["xs","sm","md"].includes(a)},rounded:{type:Boolean,default:!1}},setup(a){const t=a,l=U(()=>{const i={xs:"px-1.5 py-0.5 text-xs",sm:"px-2 py-1 text-xs",md:"px-2.5 py-1.5 text-sm"};return we("inline-flex items-center font-medium",t.rounded?"rounded-full":"rounded-md",i[t.size],$e("badge",t.variant))});return(i,o)=>(f(),m("span",{class:ce(l.value)},[I(i.$slots,"default")],2))}};function nt(a={}){const{endpoint:t,columns:l=[],defaultFilters:i={},actions:o={},defaultPerPage:r=25,searchDebounce:c=300,transformData:C=null,onError:G=null}=a,J=D(!1),N=D(null),S=D([]),_=D([]),F=ge({current_page:1,last_page:1,per_page:r,total:0,from:null,to:null}),L=ge({q:"",page:1,per_page:r,sort_by:null,sort_direction:"asc",...i}),x=ge({sortColumn:null,sortDirection:"asc",searchQuery:"",processing:new Set}),W=U(()=>S.value.length>0),w=U(()=>!J.value&&S.value.length===0),X=U(()=>F.total||0),ee=U(()=>{if(!F.total)return"";const n=F.from||0,b=F.to||0,R=F.total||0;return`${n}-${b} de ${R}`}),Y=U(()=>_.value.length>0),q=U(()=>W.value&&S.value.every(n=>_.value.includes(n.id))),g=async(n={})=>{var b,R,V;if(!t){console.error("useGenericTable: endpoint is required");return}J.value=!0,N.value=null;try{const A={...L,...n},y=await Q.get(t,{params:A});let p=((b=y.data)==null?void 0:b.data)||y.data;C&&typeof C=="function"&&(p=C(p)),S.value=(p==null?void 0:p.items)||p||[],p!=null&&p.pagination&&Object.assign(F,p.pagination)}catch(A){const y=((V=(R=A.response)==null?void 0:R.data)==null?void 0:V.message)||"Error al cargar los datos";N.value=y,G&&typeof G=="function"?G(A,y):console.error("Table fetch error:",A)}finally{J.value=!1}},E=async(n={})=>{Object.assign(L,n),await g()},O=async n=>{await E({page:n})},de=async n=>{await E({per_page:n,page:1})},se=async n=>{x.searchQuery=n,await E({q:n,page:1})},ue=async n=>{let b="asc";x.sortColumn===n&&(b=x.sortDirection==="asc"?"desc":"asc"),x.sortColumn=n,x.sortDirection=b,await E({sort_by:n,sort_direction:b,page:1})},re=async()=>{await g()},oe=async()=>{Object.assign(L,{q:"",page:1,per_page:r,sort_by:null,sort_direction:"asc",...i}),x.sortColumn=null,x.sortDirection="asc",x.searchQuery="",await g()},le=n=>{_.value.includes(n)||_.value.push(n)},te=n=>{const b=_.value.indexOf(n);b>-1&&_.value.splice(b,1)},d=n=>{_.value.includes(n)?te(n):le(n)},s=()=>{_.value=S.value.map(n=>n.id)},u=()=>{_.value=[]},T=()=>{q.value?u():s()},h=async(n,b,R=null)=>{var V,A;if(!o[n])return console.error(`Action '${n}' is not defined`),!1;x.processing.add(b);try{const y=await o[n](b,R);if(n==="delete"){const p=S.value.findIndex(fe=>fe.id===b);p>-1&&S.value.splice(p,1),te(b)}else if(y!=null&&y.data){const p=S.value.findIndex(fe=>fe.id===b);p>-1&&(S.value[p]={...S.value[p],...y.data})}return y}catch(y){const p=((A=(V=y.response)==null?void 0:V.data)==null?void 0:A.message)||`Error en acción ${n}`;throw N.value=p,y}finally{x.processing.delete(b)}},j=async(n,b,R=null)=>{const V=[],A=[];for(const y of b)try{const p=await h(n,y,R);V.push({id:y,result:p})}catch(p){A.push({id:y,error:p})}return A.length>0&&console.error("Bulk action errors:",A),{results:V,errors:A}},B=n=>x.processing.has(n);let ne;const pe=n=>{clearTimeout(ne),ne=setTimeout(()=>{se(n)},c)};return ye(()=>x.searchQuery,(n,b)=>{n!==b&&pe(n)}),{loading:J,error:N,items:S,pagination:F,filters:L,tableState:x,selectedItems:_,hasData:W,isEmpty:w,totalCount:X,paginationInfo:ee,hasSelectedItems:Y,allItemsSelected:q,fetchData:g,applyFilters:E,changePage:O,changePerPage:de,handleSearch:se,handleSort:ue,refresh:re,reset:oe,selectItem:le,unselectItem:te,toggleSelection:d,selectAll:s,unselectAll:u,toggleSelectAll:T,performAction:h,bulkAction:j,isProcessing:B,debouncedSearch:pe}}class it{constructor(t){this.baseEndpoint=t}async create(t){try{const l=t instanceof FormData?{headers:{"Content-Type":"multipart/form-data"}}:{};return(await Q.post(this.baseEndpoint,t,l)).data}catch(l){throw l}}async update(t,l){var i;try{const o=l instanceof FormData?{headers:{"Content-Type":"multipart/form-data"}}:{};try{return(await Q.put(`${this.baseEndpoint}/${t}`,l,o)).data}catch(r){const c=(i=r==null?void 0:r.response)==null?void 0:i.status;if(c===404||c===405)return(await Q.patch(`${this.baseEndpoint}/${t}`,l,o)).data;throw r}}catch(o){throw o}}async delete(t){try{return(await Q.delete(`${this.baseEndpoint}/${t}`)).data}catch(l){throw l}}async archive(t){try{return(await Q.patch(`${this.baseEndpoint}/${t}/archive`)).data}catch(l){throw l}}async restore(t){try{return(await Q.patch(`${this.baseEndpoint}/${t}/restore`)).data}catch(l){throw l}}getSweetAlertTheme(){return document.documentElement.classList.contains("dark")?{background:"#0f172a",color:"#f1f5f9",confirmButtonColor:"#ef4444",cancelButtonColor:"#64748b"}:{background:"#ffffff",color:"#1e293b",confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280"}}async confirmDelete(t,l=null){const i=l||`Se eliminará permanentemente "${t}"`,o=this.getSweetAlertTheme();return(await K.fire({title:"¿Eliminar elemento?",text:i,icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:o.confirmButtonColor,cancelButtonColor:o.cancelButtonColor,background:o.background,color:o.color,reverseButtons:!0})).isConfirmed}async confirmArchive(t,l=null){const i=l||`Se archivará "${t}"`,o=this.getSweetAlertTheme();return(await K.fire({title:"¿Archivar elemento?",text:i,icon:"question",showCancelButton:!0,confirmButtonText:"Sí, archivar",cancelButtonText:"Cancelar",confirmButtonColor:"#f59e0b",cancelButtonColor:o.cancelButtonColor,background:o.background,color:o.color,reverseButtons:!0})).isConfirmed}async confirmBulkAction(t,l){const i=this.getSweetAlertTheme(),r={delete:{title:"¿Eliminar elementos?",text:`Se eliminarán ${l} elementos permanentemente`,confirmText:"Sí, eliminar todos",color:"#ef4444"},archive:{title:"¿Archivar elementos?",text:`Se archivarán ${l} elementos`,confirmText:"Sí, archivar todos",color:"#f59e0b"}}[t];return r?(await K.fire({title:r.title,text:r.text,icon:"warning",showCancelButton:!0,confirmButtonText:r.confirmText,cancelButtonText:"Cancelar",confirmButtonColor:r.color,cancelButtonColor:i.cancelButtonColor,background:i.background,color:i.color,reverseButtons:!0})).isConfirmed:!1}showSuccess(t,l="¡Éxito!"){const i=this.getSweetAlertTheme();K.fire({title:l,text:t,icon:"success",timer:2e3,showConfirmButton:!1,background:i.background,color:i.color})}showError(t,l="Error"){const i=this.getSweetAlertTheme();K.fire({title:l,text:t,icon:"error",background:i.background,color:i.color})}async bulkDelete(t){try{const l=t.map(c=>this.delete(c)),i=await Promise.allSettled(l),o=i.filter(c=>c.status==="fulfilled").length,r=i.filter(c=>c.status==="rejected").length;return r===0?this.showSuccess(`${o} elementos eliminados correctamente`):this.showError(`${o} elementos eliminados, ${r} fallaron`),{successful:o,failed:r}}catch(l){throw l}}async bulkArchive(t){try{const l=t.map(c=>this.archive(c)),i=await Promise.allSettled(l),o=i.filter(c=>c.status==="fulfilled").length,r=i.filter(c=>c.status==="rejected").length;return r===0?this.showSuccess(`${o} elementos archivados correctamente`):this.showError(`${o} elementos archivados, ${r} fallaron`),{successful:o,failed:r}}catch(l){throw l}}}function ct(a){return new it(a)}function dt(a){const t=ct(a);return{actions:t,performAction:async(o,r,c=null,C="")=>{switch(o){case"delete":return await t.confirmDelete(C)?(await t.delete(r),t.showSuccess("Elemento eliminado correctamente"),!0):!1;case"archive":return await t.confirmArchive(C)?(await t.archive(r),t.showSuccess("Elemento archivado correctamente"),!0):!1;case"update":return await t.update(r,c),t.showSuccess("Elemento actualizado correctamente"),!0;case"create":const G=await t.create(c);return t.showSuccess("Elemento creado correctamente"),G;default:throw new Error(`Action '${o}' not supported`)}},performBulkAction:async(o,r)=>{if(!r.length||!await t.confirmBulkAction(o,r.length))return!1;switch(o){case"delete":return await t.bulkDelete(r);case"archive":return await t.bulkArchive(r);default:throw new Error(`Bulk action '${o}' not supported`)}}}}const ut={class:"border-b border-gray-100 bg-white hover:bg-blue-50/40 transition-colors dark:border-slate-800 dark:bg-slate-900 dark:hover:bg-slate-800/60"},ft={class:"px-4 py-3 font-medium text-gray-900 dark:text-slate-100"},gt={class:"px-4 py-3"},mt={class:"flex items-center gap-3"},pt={class:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center dark:bg-blue-900"},bt={class:"text-sm font-medium text-blue-600 dark:text-blue-300"},ht={class:"font-medium text-gray-900 dark:text-slate-100"},yt={class:"text-sm text-gray-500 dark:text-slate-400"},vt={class:"px-4 py-3"},xt={class:"flex flex-wrap gap-1"},kt={class:"px-4 py-3 text-sm text-gray-500 dark:text-slate-400"},wt={class:"px-4 py-3"},$t={class:"flex items-center gap-2"},Ct={class:"py-2"},St={class:"grid grid-cols-1 gap-5"},Bt={class:"space-y-5"},At={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Pt=["value"],_t={class:"space-y-3"},Et={class:"flex items-center gap-4"},Tt={class:"w-16 h-16 rounded-full overflow-hidden bg-gray-100 dark:bg-slate-800 flex items-center justify-center"},Dt=["src"],jt={key:1,class:"text-sm text-gray-500 dark:text-slate-400"},It={class:"flex-1"},zt={key:0,class:"space-y-3"},Ft={class:"flex items-center justify-between pt-4"},Mt={class:"flex items-center gap-3"},Ut={class:"flex items-center justify-center"},qt={key:0,class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Gt={__name:"UsersTable",setup(a){const t=[{key:"id",label:"ID",sortable:!0},{key:"name",label:"Usuario",sortable:!0},{key:"roles",label:"Roles"},{key:"created_at",label:"Creado",sortable:!0},{key:"actions",label:"Acciones"}],{loading:l,error:i,items:o,pagination:r,filters:c,tableState:C,paginationInfo:G,fetchData:J,changePage:N,changePerPage:S,handleSearch:_,handleSort:F,isProcessing:L,refresh:x}=nt({endpoint:"/users/data",defaultFilters:{},actions:{},defaultPerPage:25}),{performAction:W}=dt("/users"),w=D(null),X=D(!1),ee=D(!1),Y=D(null),q=D(["employee"]),g=D({name:"",email:"",role:"employee",password:""}),E=D(null),O=D(null),de=d=>d?new Date(d).toLocaleString("es-ES"):"",se=d=>{var T,h;const u=(Array.isArray(d==null?void 0:d.roles)?(T=d.roles[0])==null?void 0:T.name:null)||(d==null?void 0:d.role)||"employee";w.value=d,g.value={name:d.name,email:d.email,role:u,password:""},O.value=d.profile_photo_url||d.profile_photo_path||null,E.value=null,(h=Y.value)==null||h.open()},ue=async d=>{await W("delete",d.id,null,d.name)&&x()},re=async()=>{var d,s,u,T;X.value=!0;try{const h=g.value.role||"employee";let j=null;if(E.value){const B=new FormData;B.append("name",g.value.name),B.append("email",g.value.email),B.append("role",h),w.value||(B.append("password",g.value.password),B.append("password_confirmation",g.value.password)),B.append("photo",E.value),j=B}else j={...g.value},j.role=h,!w.value&&g.value.password&&(j.password_confirmation=g.value.password);w.value?await W("update",w.value.id,j):await W("create",null,j),oe(),x()}catch(h){console.error("Error saving user:",h);const j=((s=(d=h==null?void 0:h.response)==null?void 0:d.data)==null?void 0:s.message)||"No se pudo guardar el usuario.",B=(T=(u=h==null?void 0:h.response)==null?void 0:u.data)==null?void 0:T.errors;if(B&&typeof B=="object"){const ne=Object.values(B).flat().filter(Boolean).join("<br>");K.fire({title:"Validación fallida",html:ne||j,icon:"error"})}else K.fire({title:"Error",text:j,icon:"error"})}finally{X.value=!1}},oe=()=>{var d;w.value=null,g.value={name:"",email:"",role:"employee",password:""},E.value=null,O.value=null,(d=Y.value)==null||d.close(),be(()=>{ee.value=!1})};ye(()=>ee.value,d=>{d&&(g.value={name:"",email:"",role:"employee",password:""},w.value=null,E.value=null,O.value=null,be(()=>{var s;(s=Y.value)==null||s.open()}))});const le=d=>{const s=d.target.files&&d.target.files[0];if(!s)return;E.value=s;const u=new FileReader;u.onload=T=>{O.value=T.target.result},u.readAsDataURL(s)},te=async()=>{try{const{data:d}=await Q.get("/users/role-options"),s=Array.isArray(d==null?void 0:d.data)?d.data.filter(Boolean):[];q.value=s.length>0?s:["employee"],q.value.includes(g.value.role)||(g.value.role=q.value[0])}catch{q.value=["employee"]}};return ve(async()=>{await te(),await J()}),(d,s)=>(f(),m(Z,null,[M(ot,{"table-id":"users-table",title:"Usuarios",columns:t,items:P(o),loading:P(l),error:P(i),pagination:P(r),"pagination-info":P(G),"search-query":P(C).searchQuery,"search-placeholder":"Buscar por nombre o email","per-page":P(c).per_page,"per-page-options":[10,25,50,100],sortable:"",onSearch:P(_),onSort:P(F),onPageChange:P(N),onPerPageChange:P(S)},{headerActions:$(()=>[M(H,{variant:"primary",onClick:s[0]||(s[0]=u=>ee.value=!0)},{default:$(()=>[...s[5]||(s[5]=[z(" Crear Usuario ",-1)])]),_:1})]),row:$(({item:u})=>{var T;return[e("tr",ut,[e("td",ft,v(u.id),1),e("td",gt,[e("div",mt,[e("div",pt,[e("span",bt,v((T=u.name)==null?void 0:T.charAt(0).toUpperCase()),1)]),e("div",null,[e("div",ht,v(u.name),1),e("div",yt,v(u.email),1)])])]),e("td",vt,[e("div",xt,[(f(!0),m(Z,null,ae(u.roles,h=>(f(),he(lt,{key:h.id,variant:"primary",size:"xs",rounded:""},{default:$(()=>[z(v(h.name),1)]),_:2},1024))),128))])]),e("td",kt,v(de(u.created_at)),1),e("td",wt,[e("div",$t,[M(H,{variant:"ghost",size:"sm",loading:P(L)(u.id),onClick:h=>se(u)},{default:$(()=>[...s[6]||(s[6]=[z(" Editar ",-1)])]),_:1},8,["loading","onClick"]),M(H,{variant:"ghost",size:"sm",loading:P(L)(u.id),onClick:h=>ue(u)},{default:$(()=>[...s[7]||(s[7]=[z(" Eliminar ",-1)])]),_:1},8,["loading","onClick"])])])])]}),_:1},8,["items","loading","error","pagination","pagination-info","search-query","per-page","onSearch","onSort","onPageChange","onPerPageChange"]),M(Ce,{ref_key:"userModal",ref:Y,title:w.value?"Editar Usuario":"Crear Usuario",subtitle:w.value?`Modificar datos de ${w.value.name}`:"Agregar nuevo usuario al sistema","max-width":"xl","close-on-backdrop":""},{footer:$(()=>[e("div",Ft,[s[19]||(s[19]=e("div",{class:"text-xs text-gray-500 dark:text-slate-400"}," * Campos obligatorios ",-1)),e("div",Mt,[M(H,{variant:"secondary",size:"sm",onClick:oe},{default:$(()=>[...s[17]||(s[17]=[z(" Cancelar ",-1)])]),_:1}),M(H,{variant:"primary",size:"sm",loading:X.value,disabled:!g.value.name||!g.value.email||!w.value&&!g.value.password,onClick:re},{default:$(()=>[e("div",Ut,[X.value?k("",!0):(f(),m("svg",qt,[...s[18]||(s[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),e("span",null,v(w.value?"Actualizar":"Crear"),1)])]),_:1},8,["loading","disabled"])])])]),default:$(()=>[e("div",Ct,[e("form",{onSubmit:xe(re,["prevent"])},[e("div",St,[e("div",Bt,[s[16]||(s[16]=e("div",{class:"border-b border-gray-200 dark:border-slate-700 pb-3"},[e("h4",{class:"text-base font-semibold text-gray-900 dark:text-slate-100"},"Información Personal"),e("p",{class:"text-sm text-gray-600 dark:text-slate-400"},"Datos básicos del usuario")],-1)),e("div",At,[e("div",null,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2"}," Nombre completo * ",-1)),ie(e("input",{"onUpdate:modelValue":s[1]||(s[1]=u=>g.value.name=u),type:"text",required:"",placeholder:"Ej: Juan Carlos Pérez",class:"block w-full rounded-lg border border-gray-300 px-3 py-2.5 text-sm shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-100 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100 dark:placeholder:text-slate-400 dark:focus:border-blue-500 dark:focus:ring-blue-500/20"},null,512),[[me,g.value.name]])]),e("div",null,[s[9]||(s[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2"}," Correo electrónico * ",-1)),ie(e("input",{"onUpdate:modelValue":s[2]||(s[2]=u=>g.value.email=u),type:"email",required:"",placeholder:"usuario@empresa.com",class:"block w-full rounded-lg border border-gray-300 px-3 py-2.5 text-sm shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-100 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100 dark:placeholder:text-slate-400 dark:focus:border-blue-500 dark:focus:ring-blue-500/20"},null,512),[[me,g.value.email]])]),e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2"}," Rol * ",-1)),ie(e("select",{"onUpdate:modelValue":s[3]||(s[3]=u=>g.value.role=u),class:"block w-full rounded-lg border border-gray-300 px-3 py-2.5 text-sm shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-100 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100 dark:focus:border-blue-500 dark:focus:ring-blue-500/20"},[(f(!0),m(Z,null,ae(q.value,u=>(f(),m("option",{key:u,value:u},v(u),9,Pt))),128))],512),[[ke,g.value.role]])])]),e("div",_t,[s[12]||(s[12]=e("div",{class:"border-b border-gray-200 dark:border-slate-700 pb-3"},[e("h4",{class:"text-base font-semibold text-gray-900 dark:text-slate-100"},"Foto de perfil"),e("p",{class:"text-sm text-gray-600 dark:text-slate-400"},"Sube una foto para el usuario (opcional)")],-1)),e("div",Et,[e("div",Tt,[O.value?(f(),m("img",{key:0,src:O.value,alt:"Preview",class:"w-full h-full object-cover"},null,8,Dt)):(f(),m("div",jt,"Sin foto"))]),e("div",It,[e("input",{type:"file",accept:"image/*",onChange:le,class:"block w-full text-sm text-gray-500 file:bg-white file:border file:rounded file:px-3 file:py-1 file:mr-3 file:border-gray-300 file:text-sm file:cursor-pointer dark:file:bg-slate-800"},null,32),s[11]||(s[11]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-slate-400"},"Formatos: JPG, PNG. Tamaño recomendado: 300x300px",-1))])])]),w.value?k("",!0):(f(),m("div",zt,[s[15]||(s[15]=e("div",{class:"border-b border-gray-200 dark:border-slate-700 pb-3"},[e("h4",{class:"text-base font-semibold text-gray-900 dark:text-slate-100"},"Configuración de Acceso"),e("p",{class:"text-sm text-gray-600 dark:text-slate-400"},"Contraseña para el nuevo usuario")],-1)),e("div",null,[s[13]||(s[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2"}," Contraseña * ",-1)),ie(e("input",{"onUpdate:modelValue":s[4]||(s[4]=u=>g.value.password=u),type:"password",required:"",placeholder:"Mínimo 8 caracteres",class:"block w-full rounded-lg border border-gray-300 px-3 py-2.5 text-sm shadow-sm transition-colors focus:border-blue-500 focus:ring-2 focus:ring-blue-100 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-100 dark:placeholder:text-slate-400 dark:focus:border-blue-500 dark:focus:ring-blue-500/20"},null,512),[[me,g.value.password]]),s[14]||(s[14]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-slate-400"}," La contraseña debe tener al menos 8 caracteres ",-1))])]))])])],32)])]),_:1},8,["title","subtitle"])],64))}};export{Gt as default};
