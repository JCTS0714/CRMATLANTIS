# 2026-01-16 — Notas / Avance

## Objetivo
- Hacer visible y asignable la UI de campañas de correo masivo y ordenar las opciones de mensajería masiva en el menú.

## Hecho hoy
- Permisos:
  - Se aseguró la existencia del permiso `menu.email` en seeders (Spatie Permissions).
  - Se ajustó la UI de Roles para que los permisos `menu.*` (módulos del menú) no dependan de una lista fija, sino que se construyan desde los permisos disponibles.

- Menú (Sidebar):
  - Se creó una nueva opción **“Bandeja de entrada”** con dropdown/flyout (hover cuando está colapsado), similar al comportamiento del menú de Leads/Pipeline.
  - Se movieron las opciones de mensajería masiva al nuevo menú:
    - **WhatsApp masivo** → `/leads/whatsapp`
    - **Email masivo** → `/leads/email`
  - Se corrigió el resaltado del ícono de Leads/Pipeline para que NO se marque cuando el usuario está dentro de “Bandeja de entrada” (rutas `/leads/whatsapp` y `/leads/email`).

## Archivos tocados (principales)
- `resources/js/components/RolesTable.vue`
  - Módulos del menú ahora se derivan dinámicamente desde los permisos `menu.*`.

- `database/seeders/RolesAndPermissionsSeeder.php`
  - Incluye `menu.email` dentro del set estándar de permisos.

- `resources/js/components/Sidebar.vue`
  - Nuevo menú: “Bandeja de entrada” (expandido + flyout colapsado).
  - Removidas las entradas de WhatsApp/Email del dropdown de Leads/Pipeline.
  - Fix de estado “active” para Pipeline/Leads usando match exacto en `/leads`.

## Comandos usados / verificación
- Seed permisos: `php artisan db:seed --class=RolesAndPermissionsSeeder`
- Build assets: `npm run build`

## Commits locales relevantes
- `bd38116` Add menu.email permission to roles UI
- `ef236c2` Derive menu modules from permissions
- `6f0fb65` Show Email masivo in collapsed Pipeline dropdown
- `150c769` Add Bandeja de entrada menu for mass messaging
- `fb1a955` Fix Leads highlight when using Bandeja de entrada

## Notas
- El repo remoto sigue en `origin/main` con commit base `a0aac2a` (no se hizo push hoy).
- Queda pendiente revisar por qué `npm run dev` estuvo fallando en este entorno (no bloquea producción si se usa `npm run build`).
